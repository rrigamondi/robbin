<!doctype html>
<html>

<head>
   <meta charset="UTF-8" />
   <title>301_Robin-Hood_Robbin the Crown</title>
   <script src="//cdn.jsdelivr.net/phaser/2.5.0/phaser.min.js"></script>
     <link id="stylesheet" rel="stylesheet" type="text/css" href="stylesheet.css"/>
</head>

<body class="game">
  <div>
   <script type="text/javascript">
     window.onload = function() {

      var game = new Phaser.Game(1024, 768, Phaser.AUTO, '', {
         preload: preload,
         create: create,
         update: update
      });
      window.game = game;















      function preload() {

        //fondamenta
        game.load.image('background', 'Assets/Bosco/Background_Foreground/Background_bosco.png');
        game.load.image('foreground', 'Assets/Bosco/Background_Foreground/PrimoPiano_bosco.png');
        game.load.image('platform1', 'Assets/Bosco/Fondamenta/Piattaforma_1.png');
        game.load.image('platform2', 'Assets/Bosco/Fondamenta/Piattaforma_2.png');
        game.load.image('platform3', 'Assets/Bosco/Fondamenta/Piattaforma_3.png');
        game.load.image('platform4', 'Assets/Bosco/Fondamenta/Piattaforma_4.png');
        game.load.image('step1', 'Assets/Bosco/Fondamenta/Gradino_1.png');
        game.load.image('step2', 'Assets/Bosco/Fondamenta/Gradino_2.png');
        game.load.image('step3', 'Assets/Bosco/Fondamenta/Gradino_3.png');
        game.load.image('step4', 'Assets/Bosco/Fondamenta/Gradino_4.png');
        game.load.image('step5', 'Assets/Bosco/Fondamenta/Gradino_5.png');
        game.load.image('step6', 'Assets/Bosco/Fondamenta/Gradino_6.png');
        game.load.image('stump1', 'Assets/Bosco/Fondamenta/Ceppo_1.png');
        game.load.image('ogginvisibile', 'Assets/Bosco/Fondamenta/OggInvisibile.png');
        game.load.image('platform_a', 'Assets/Bosco/Fondamenta/Piattaforma_A.png');
        game.load.image('platform_b', 'Assets/Bosco/Fondamenta/Piattaforma_B.png');
        game.load.image('platform_c', 'Assets/Bosco/Fondamenta/Piattaforma_C.png');
        game.load.image('platform_d', 'Assets/Bosco/Fondamenta/Piattaforma_D.png');
        game.load.image('platform_e', 'Assets/Bosco/Fondamenta/Piattaforma_E.png');
        game.load.image('platform_g', 'Assets/Bosco/Fondamenta/Piattaforma_G.png');
        game.load.image('platform_h', 'Assets/Bosco/Fondamenta/Piattaforma_H.png');
        game.load.image('platform_i', 'Assets/Bosco/Fondamenta/Piattaforma_I.png');
        game.load.image('platform_j', 'Assets/Bosco/Fondamenta/Piattaforma_J.png');
        game.load.image('platform_k', 'Assets/Bosco/Fondamenta/Piattaforma_K.png');
        game.load.image('platform_l', 'Assets/Bosco/Fondamenta/Piattaforma_L.png');


        //level_design
        game.load.image('corda', 'Assets/Bosco/level_design/Corda.png');
        game.load.image('tutorial_freccia', 'Assets/Bosco/level_design/Tutorial_freccia.png');

        game.load.image('albero_1', 'Assets/Bosco/level_design/Albero_1.png');
        game.load.image('albero_2', 'Assets/Bosco/level_design/Albero_2.png');
        game.load.image('bersaglio', 'Assets/Bosco/level_design/Bersaglio.png');
        game.load.image('corrente_1', 'Assets/Bosco/level_design/Corrente_1.png');
        game.load.image('corrente_2', 'Assets/Bosco/level_design/Corrente_2.png');
        game.load.image('corrente_3', 'Assets/Bosco/level_design/Corrente_3.png');
        game.load.image('corrente_4', 'Assets/Bosco/level_design/Corrente_4.png');
        game.load.image('corrente_5', 'Assets/Bosco/level_design/Corrente_5.png');
        game.load.image('corrente_6', 'Assets/Bosco/level_design/Corrente_6.png');
        game.load.image('piattaforma_1', 'Assets/Bosco/level_design/Piattaforma_1.png');

        game.load.image('piattaforma_3', 'Assets/Bosco/level_design/Piattaforma_3.png');
        game.load.image('piattaforma_4', 'Assets/Bosco/level_design/Piattaforma_4.png');
        game.load.image('piattaforma_5', 'Assets/Bosco/level_design/Piattaforma_5.png');
        game.load.image('piattaforma_6', 'Assets/Bosco/level_design/Piattaforma_6.png');
        game.load.image('piattaforma_7', 'Assets/Bosco/level_design/Piattaforma_7.png');
        game.load.image('piattaforma_7_2', 'Assets/Bosco/level_design/Piattaforma_7_2.png');
        game.load.image('piattaforma_8', 'Assets/Bosco/level_design/Piattaforma_8.png');
        game.load.image('piattaforma_8_2', 'Assets/Bosco/level_design/Piattaforma_8_2.png');
        game.load.image('piattaforma_9', 'Assets/Bosco/level_design/Piattaforma_9.png');
        game.load.image('piattaforma_9_2', 'Assets/Bosco/level_design/Piattaforma_9_2.png');
        game.load.image('piattaforma_10', 'Assets/Bosco/level_design/Piattaforma_10.png');


        //grotta
        game.load.image('gradino_grotta_0', 'Assets/Bosco/grotta/Gradino_Grotta_0.png');
        game.load.image('gradino_grotta_1', 'Assets/Bosco/grotta/Gradino_Grotta_1.png');
        game.load.image('gradino_grotta_2', 'Assets/Bosco/grotta/Gradino_Grotta_2.png');
        game.load.image('gradino_grotta_3', 'Assets/Bosco/grotta/Gradino_Grotta_3.png');
        game.load.image('gradino_grotta_4', 'Assets/Bosco/grotta/Gradino_Grotta_4.png');
        game.load.image('gradino_grotta_5', 'Assets/Bosco/grotta/Gradino_Grotta_5.png');


        //Breakable environment
        game.load.image('blocco_1', 'Assets/Bosco/level_design/Blocco_1.png');
        game.load.image('blocco_2', 'Assets/Bosco/grotta/Blocco_2.png');


        //Abilities
        game.load.image('malebullet', 'Assets/Abilities/0_roccia.png');
        game.load.image('femalebullet', 'Assets/Abilities/0_freccia.png');
        game.load.image('bomb', 'Assets/Abilities/0_bomba.png');
        game.load.image('apple', 'Assets/Abilities/0_mela.png');
        game.load.spritesheet('explosion', 'Assets/Abilities/spritesheet_explosion.png', 71, 71);


        //Personaggi
        game.load.spritesheet('player', 'Assets/Personaggi/spritesheet_player.png', 65, 95);
        game.load.spritesheet('enemy', 'Assets/Personaggi/spritesheet_enemy.png', 78, 105);


        //hud
        game.load.image('n_00', 'Assets/HUD/elementi-hud_00.png');
        game.load.image('n_01', 'Assets/HUD/elementi-hud_01.png');
        game.load.image('n_02', 'Assets/HUD/elementi-hud_02.png');
        game.load.image('n_03', 'Assets/HUD/elementi-hud_03.png');
        game.load.image('n_04', 'Assets/HUD/elementi-hud_04.png');
        game.load.image('n_05', 'Assets/HUD/elementi-hud_05.png');
        game.load.image('n_06', 'Assets/HUD/elementi-hud_06.png');
        game.load.image('n_07', 'Assets/HUD/elementi-hud_07.png');
        game.load.image('n_08', 'Assets/HUD/elementi-hud_08.png');
        game.load.image('n_09', 'Assets/HUD/elementi-hud_09.png');
        game.load.image('n_10', 'Assets/HUD/elementi-hud_10.png');
        game.load.image('n_11', 'Assets/HUD/elementi-hud_11.png');
        game.load.image('n_12', 'Assets/HUD/elementi-hud_12.png');
        game.load.image('n_13', 'Assets/HUD/elementi-hud_13.png');
        game.load.image('n_14', 'Assets/HUD/elementi-hud_14.png');
        game.load.image('n_15', 'Assets/HUD/elementi-hud_15.png');

        game.load.image('hp_1_G', 'Assets/HUD/elementi-hud_ghunter1.png');
        game.load.image('hp_2_G', 'Assets/HUD/elementi-hud_ghunter2.png');
        game.load.image('hp_3_G', 'Assets/HUD/elementi-hud_ghunter3.png');
        game.load.image('hp_1_E', 'Assets/HUD/elementi-hud_elizabeth1.png');
        game.load.image('hp_2_E', 'Assets/HUD/elementi-hud_elizabeth2.png');
        game.load.image('hp_3_E', 'Assets/HUD/elementi-hud_elizabeth3.png');


        //sign_messages
        game.load.image('cartello', 'Assets/Sign_messages/Cartello_1.png');
        game.load.image('tutorial_1', 'Assets/Sign_messages/txt_tutorial_1.png');
        game.load.image('tutorial_2', 'Assets/Sign_messages/txt_tutorial_2.png');
        game.load.image('tutorial_3', 'Assets/Sign_messages/txt_tutorial_3.png');
        game.load.image('tutorial_4', 'Assets/Sign_messages/txt_tutorial_4.png');
        game.load.image('tutorial_5', 'Assets/Sign_messages/txt_tutorial_5.png');
        game.load.image('tutorial_6', 'Assets/Sign_messages/txt_tutorial_6.png');
        game.load.image('tutorial_7', 'Assets/Sign_messages/txt_tutorial_7.png');
        game.load.image('tutorial_8', 'Assets/Sign_messages/txt_tutorial_8.png');
        game.load.image('istruzioni', 'Assets/Sign_messages/istruzioni.png');
        game.load.image('lettera_aperta', 'Assets/Sign_messages/lettera_aperta.png');
        game.load.image('lettera_chiusa', 'Assets/Sign_messages/lettera_chiusa.png');


        //stanza_segreta
        game.load.image('copertura_piattaforma_f', 'Assets/Bosco/Stanza_segreta/Copertura_piattaforma_f.png');
        game.load.image('gradino_piattaforma_f', 'Assets/Bosco/Stanza_segreta/Gradino_piattaforma_f.png');
        game.load.image('muro_piattaforma_f', 'Assets/Bosco/Stanza_segreta/Muro_piattaforma_f.png');
        game.load.image('piattaforma_f_2', 'Assets/Bosco/Stanza_segreta/Piattaforma_f_2.png');


        //checkpoints
        game.load.spritesheet('fuoco', 'Assets/Bosco/Checkpoint/spritesheet_checkpoint.png', 422, 275);


        //pause
        game.load.image('pausa', 'Assets/HUD/elementi-hud_pausa.png');


        //menu_pausa_e_copertina
        game.load.image('menu_pausa', 'Assets/copertina_menu/menu/menu.png');

        game.load.image('copertina', 'Assets/copertina_menu/copertina/copertina.png');

        game.load.image('autori_1', 'Assets/copertina_menu/copertina/crediti/credits-01.png');

        game.load.image('render_storia1', 'Assets/copertina_menu/copertina/leggenda/Render_Storia1.png');
        game.load.image('render_storia2', 'Assets/copertina_menu/copertina/leggenda/Render_Storia2.png');
        game.load.image('render_storia3', 'Assets/copertina_menu/copertina/leggenda/Render_Storia3.png');
        game.load.image('render_storia4', 'Assets/copertina_menu/copertina/leggenda/Render_Storia4.png');
        game.load.image('render_storia5', 'Assets/copertina_menu/copertina/leggenda/Render_Storia5.png');
        game.load.image('render_storia6', 'Assets/copertina_menu/copertina/leggenda/Render_Storia6.png');
        game.load.image('render_storia7', 'Assets/copertina_menu/copertina/leggenda/Render_Storia7.png');
        game.load.image('render_storia8', 'Assets/copertina_menu/copertina/leggenda/Render_Storia8.png');
        game.load.image('render_storia9', 'Assets/copertina_menu/copertina/leggenda/Render_Storia9.png');
        game.load.image('render_storia10', 'Assets/copertina_menu/copertina/leggenda/Render_Storia10.png');
        game.load.image('render_storia11', 'Assets/copertina_menu/copertina/leggenda/Render_Storia11.png');
        game.load.image('render_storia12', 'Assets/copertina_menu/copertina/leggenda/Render_Storia12.png');
        game.load.image('render_storia13', 'Assets/copertina_menu/copertina/leggenda/Render_Storia13.png');
        game.load.image('render_storia14', 'Assets/copertina_menu/copertina/leggenda/Render_Storia14.png');
        game.load.image('render_storia15', 'Assets/copertina_menu/copertina/leggenda/Render_Storia15.png');
        game.load.image('render_finale', 'Assets/copertina_menu/copertina/leggenda/Render_Finale.png');
        game.load.image('render_finalefelice', 'Assets/copertina_menu/copertina/leggenda/Render_FinaleFelice.png');
        game.load.image('render_gameover', 'Assets/copertina_menu/copertina/leggenda/Render_GameOver.png');

        game.load.image('extra_1', 'Assets/copertina_menu/copertina/extra/extra_1.png');
        game.load.image('extra_2', 'Assets/copertina_menu/copertina/extra/extra_2.png');
        game.load.image('extra_3', 'Assets/copertina_menu/copertina/extra/extra_3.png');
        game.load.image('extra_4', 'Assets/copertina_menu/copertina/extra/extra_4.png');
        game.load.image('extra_5', 'Assets/copertina_menu/copertina/extra/extra_5.png');
        game.load.image('extra_6', 'Assets/copertina_menu/copertina/extra/extra_6.png');
        game.load.image('extra_7', 'Assets/copertina_menu/copertina/extra/extra_7.png');
        game.load.image('extra_8', 'Assets/copertina_menu/copertina/extra/extra_8.png');


        //bosco_notturno
        game.load.image('background_bosco_notturno', 'Assets/Bosco_notturno/Background/Background_Bosco_Notte.png');
        game.load.image('transizione_bosco_castello', 'Assets/Bosco_notturno/Background/Transizione_bosco_castello.png');
        game.load.image('cancello', 'Assets/Bosco_notturno/Cancello/Cancello.png');
        game.load.image('leva_attivata', 'Assets/Bosco_notturno/Cancello/Leva_attivata.png');
        game.load.image('leva', 'Assets/Bosco_notturno/Cancello/Leva.png');
        game.load.image('muro_notte', 'Assets/Bosco_notturno/Piattaforme/Muro.png');
        game.load.image('piattaforma_notte_1', 'Assets/Bosco_notturno/Piattaforme/Piattaforma_Notte_1.png');
        game.load.image('piattaforma_notte_2', 'Assets/Bosco_notturno/Piattaforme/Piattaforma_Notte_2.png');
        game.load.image('piattaforma_notte_3', 'Assets/Bosco_notturno/Piattaforme/Piattaforma_Notte_3.png');
        game.load.image('piattaforma_notte_4', 'Assets/Bosco_notturno/Piattaforme/Piattaforma_Notte_4.png');
        game.load.image('piattaforma_notte_5', 'Assets/Bosco_notturno/Piattaforme/Piattaforma_Notte_5.png');
        game.load.image('piattaforma_notte_6', 'Assets/Bosco_notturno/Piattaforme/Piattaforma_Notte_6.png');
        game.load.image('piattaforma_notte_7', 'Assets/Bosco_notturno/Piattaforme/Piattaforma_Notte_7.png');
        game.load.image('piattaforma_notte_8', 'Assets/Bosco_notturno/Piattaforme/Piattaforma_Notte_8.png');
        game.load.image('piattaforma_notte_9', 'Assets/Bosco_notturno/Piattaforme/Piattaforma_Notte_9.png');
        game.load.image('piattaforma_notte_10', 'Assets/Bosco_notturno/Piattaforme/Piattaforma_Notte_10.png');
        game.load.image('piattaforma_notte_11', 'Assets/Bosco_notturno/Piattaforme/Piattaforma_Notte_11.png');
        game.load.image('piattaforma_notte_12', 'Assets/Bosco_notturno/Piattaforme/Piattaforma_Notte_12.png');
        game.load.image('piattaforma_notte_13', 'Assets/Bosco_notturno/Piattaforme/Piattaforma_Notte_13.png');
        game.load.image('piattaforma_notte_14', 'Assets/Bosco_notturno/Piattaforme/Piattaforma_Notte_14.png');
        game.load.image('piattaforma_notte_15', 'Assets/Bosco_notturno/Piattaforme/Piattaforma_Notte_15.png');
        game.load.image('piattaforma_notte_cade', 'Assets/Bosco_notturno/Piattaforme/piattaforma_notte_cade.png');
        game.load.image('rovo_1', 'Assets/Bosco_notturno/Rovi/Rovo_1.png');
        game.load.image('rovo_2', 'Assets/Bosco_notturno/Rovi/Rovo_2.png');
        game.load.image('rovo_3', 'Assets/Bosco_notturno/Rovi/Rovo_3.png');
        game.load.image('rovo_4', 'Assets/Bosco_notturno/Rovi/Rovo_4.png');
        game.load.image('rovo_5', 'Assets/Bosco_notturno/Rovi/Rovo_5.png');
        game.load.image('rovo_6', 'Assets/Bosco_notturno/Rovi/Rovo_6.png');
        game.load.image('rovo_7', 'Assets/Bosco_notturno/Rovi/Rovo_7.png');
        game.load.image('rovo_8', 'Assets/Bosco_notturno/Rovi/Rovo_8.png');


        //castello
        game.load.image('background_castello', 'Assets/Castello/1_Background_castello.png');
        game.load.image('livello_regolazione_castello', 'Assets/Castello/2_Livello_regolazione.png');
        game.load.image('luci_castello', 'Assets/Castello/3_Luci.png');
        game.load.image('piattaforma_castello_1', 'Assets/Castello/Piattaforma.png');
		    game.load.image('terra_castello_2', 'Assets/Castello/Terracastello.png');


        //boss_fight
        game.load.image('buco_frecce', 'Assets/Boss_fight/Buco_frecce.png');
        game.load.image('ingranaggio_1', 'Assets/Boss_fight/Ingranaggio_1.png');
        game.load.image('ingranaggio_2', 'Assets/Boss_fight/Ingranaggio_2.png');
        game.load.image('ingranaggio_3', 'Assets/Boss_fight/Ingranaggio_3.png');
        game.load.image('torre', 'Assets/Boss_fight/Torre.png');
        game.load.image('cancello_sotto', 'Assets/Boss_fight/Cancello_sotto.png');
        game.load.image('cancello_sopra', 'Assets/Boss_fight/Cancello_sopra.png');
        game.load.image('piattaforma1_boss_fight', 'Assets/Boss_fight/Piattaforma1_boss_fight.png');
        game.load.image('piattaforma2_boss_fight', 'Assets/Boss_fight/Piattaforma2_boss_fight.png');
        game.load.image('piattaforma3_boss_fight', 'Assets/Boss_fight/Piattaforma3_boss_fight.png');


        //boss
        game.load.spritesheet('robin', 'Assets/Personaggi/spritesheet_boss.png', 84, 120);


        //boss_hud
        game.load.image('hp_0_R', 'Assets/HUD/elementi-hud_robin0.png');
        game.load.image('hp_1_R', 'Assets/HUD/elementi-hud_robin1.png');
        game.load.image('hp_2_R', 'Assets/HUD/elementi-hud_robin2.png');
        game.load.image('hp_3_R', 'Assets/HUD/elementi-hud_robin3.png');
        game.load.image('hp_4_R', 'Assets/HUD/elementi-hud_robin4.png');
        game.load.image('hp_5_R', 'Assets/HUD/elementi-hud_robin5.png');
        game.load.image('hp_6_R', 'Assets/HUD/elementi-hud_robin6.png');


        //dialogo_finale
        game.load.image('barra_cutscene', 'Assets/Boss_fight/Dialogo_finale/barra_cutescene.png');
        game.load.image('dialogo_finale1', 'Assets/Boss_fight/Dialogo_finale/dialogo_finale1.png');
        game.load.image('dialogo_finale2', 'Assets/Boss_fight/Dialogo_finale/dialogo_finale2.png');
        game.load.image('dialogo_finale3', 'Assets/Boss_fight/Dialogo_finale/dialogo_finale3.png');
        game.load.image('dialogo_finale4', 'Assets/Boss_fight/Dialogo_finale/dialogo_finale4.png');
        game.load.image('dialogo_finale5', 'Assets/Boss_fight/Dialogo_finale/dialogo_finale5.png');
        game.load.image('dialogo_finale6', 'Assets/Boss_fight/Dialogo_finale/dialogo_finale6.png');
        game.load.image('dialogo_finale7', 'Assets/Boss_fight/Dialogo_finale/dialogo_finale7.png');
        game.load.image('dialogo_finale8', 'Assets/Boss_fight/Dialogo_finale/dialogo_finale8.png');
        game.load.image('salta', 'Assets/Boss_fight/Dialogo_finale/Salta.png');

        //mela_anim
        game.load.atlas('mela', 'Assets/Abilities/mela.png', null, meladata)
        //corrente_anim
        game.load.atlas('corrente', 'Assets/Bosco/Correnti/correnti.png', null, animdata)

      }

      //variables
      var jump;
      var floor;
      var player;
      var foreground;
      var velocity_fore;
      var newposition;
      var oldposition;
      var gravity;
      var fireButton;
      var male;
      var female;
      var swap_male;
      var swap_female;
      var newstoposition;
      var oldstoposition;
      var fermo;
      var bomb;
      var abilityButton;
      var explosion;
      var dropbomb;
      var tempo;
      var player_hp;
      var dmg;
      var apple_counter;
      var apple;
      var platform_velocity;
      var target_velocity;
      var enemy_speed;
      var last_checkpoint_x;
      var last_checkpoint_y;
      var l_bosco;
      var boss_hp;
      var change_gate;
      var direction;


	  //mela_anim
	  var meladata =  {"frames": [

      {
	     "filename": "mela_00000.png",
	     "frame": {"x":0,"y":0,"w":38,"h":50},
	     "rotated": false,
	     "trimmed": false,
	     "spriteSourceSize": {"x":0,"y":0,"w":38,"h":50},
	     "sourceSize": {"w":38,"h":50}
      },
      {
	     "filename": "mela_00001.png",
	     "frame": {"x":38,"y":0,"w":38,"h":50},
       "rotated": false,
 	     "trimmed": false,
	     "spriteSourceSize": {"x":0,"y":0,"w":38,"h":50},
	     "sourceSize": {"w":38,"h":50}
      },
      {
	     "filename": "mela_00002.png",
	     "frame": {"x":76,"y":0,"w":38,"h":50},
	     "rotated": false,
	     "trimmed": false,
	     "spriteSourceSize": {"x":0,"y":0,"w":38,"h":50},
	     "sourceSize": {"w":38,"h":50}
      },
      {
	     "filename": "mela_00003.png",
	     "frame": {"x":114,"y":0,"w":38,"h":50},
	     "rotated": false,
	     "trimmed": false,
	     "spriteSourceSize": {"x":0,"y":0,"w":38,"h":50},
	     "sourceSize": {"w":38,"h":50}
      },
      {
	     "filename": "mela_00004.png",
	     "frame": {"x":152,"y":0,"w":38,"h":50},
	     "rotated": false,
	     "trimmed": false,
	     "spriteSourceSize": {"x":0,"y":0,"w":38,"h":50},
	     "sourceSize": {"w":38,"h":50}
      },
      {
	     "filename": "mela_00005.png",
	     "frame": {"x":190,"y":0,"w":38,"h":50},
	     "rotated": false,
	     "trimmed": false,
	     "spriteSourceSize": {"x":0,"y":0,"w":38,"h":50},
	     "sourceSize": {"w":38,"h":50}
      },
      {
	     "filename": "mela_00006.png",
	     "frame": {"x":228,"y":0,"w":38,"h":50},
	     "rotated": false,
	     "trimmed": false,
	     "spriteSourceSize": {"x":0,"y":0,"w":38,"h":50},
	     "sourceSize": {"w":38,"h":50}
      },
      {
	     "filename": "mela_00007.png",
	     "frame": {"x":0,"y":50,"w":38,"h":50},
	     "rotated": false,
	     "trimmed": false,
	     "spriteSourceSize": {"x":0,"y":0,"w":38,"h":50},
	     "sourceSize": {"w":38,"h":50}
      },
      {
	     "filename": "mela_00008.png",
	     "frame": {"x":38,"y":50,"w":38,"h":50},
	     "rotated": false,
	     "trimmed": false,
	     "spriteSourceSize": {"x":0,"y":0,"w":38,"h":50},
	     "sourceSize": {"w":38,"h":50}
      },
      {
	     "filename": "mela_00009.png",
	     "frame": {"x":76,"y":50,"w":38,"h":50},
	     "rotated": false,
	     "trimmed": false,
	     "spriteSourceSize": {"x":0,"y":0,"w":38,"h":50},
	     "sourceSize": {"w":38,"h":50}
      },
      {
	     "filename": "mela_00010.png",
	     "frame": {"x":114,"y":50,"w":38,"h":50},
	     "rotated": false,
	     "trimmed": false,
	     "spriteSourceSize": {"x":0,"y":0,"w":38,"h":50},
	     "sourceSize": {"w":38,"h":50}
      },
      {
	     "filename": "mela_00011.png",
	     "frame": {"x":152,"y":50,"w":38,"h":50},
	     "rotated": false,
	     "trimmed": false,
	     "spriteSourceSize": {"x":0,"y":0,"w":38,"h":50},
	     "sourceSize": {"w":38,"h":50}
      },
      {
	     "filename": "mela_00012.png",
	     "frame": {"x":190,"y":50,"w":38,"h":50},
	     "rotated": false,
	     "trimmed": false,
	     "spriteSourceSize": {"x":0,"y":0,"w":38,"h":50},
	     "sourceSize": {"w":38,"h":50}
      },
      {
	     "filename": "mela_00013.png",
	     "frame": {"x":228,"y":50,"w":38,"h":50},
	     "rotated": false,
	     "trimmed": false,
	     "spriteSourceSize": {"x":0,"y":0,"w":38,"h":50},
	     "sourceSize": {"w":38,"h":50}
      },
      {
	     "filename": "mela_00014.png",
	     "frame": {"x":0,"y":100,"w":38,"h":50},
	     "rotated": false,
	     "trimmed": false,
	     "spriteSourceSize": {"x":0,"y":0,"w":38,"h":50},
	     "sourceSize": {"w":38,"h":50}
      },
      {
	     "filename": "mela_00015.png",
	     "frame": {"x":38,"y":100,"w":38,"h":50},
	     "rotated": false,
	     "trimmed": false,
	     "spriteSourceSize": {"x":0,"y":0,"w":38,"h":50},
	     "sourceSize": {"w":38,"h":50}
      },
      {
	     "filename": "mela_00016.png",
	     "frame": {"x":76,"y":100,"w":38,"h":50},
	     "rotated": false,
	     "trimmed": false,
	     "spriteSourceSize": {"x":0,"y":0,"w":38,"h":50},
	     "sourceSize": {"w":38,"h":50}
      },
      {
	     "filename": "mela_00017.png",
	     "frame": {"x":114,"y":100,"w":38,"h":50},
	     "rotated": false,
	     "trimmed": false,
	     "spriteSourceSize": {"x":0,"y":0,"w":38,"h":50},
	     "sourceSize": {"w":38,"h":50}
      },
      {
	     "filename": "mela_00018.png",
	     "frame": {"x":152,"y":100,"w":38,"h":50},
	     "rotated": false,
	     "trimmed": false,
	     "spriteSourceSize": {"x":0,"y":0,"w":38,"h":50},
	     "sourceSize": {"w":38,"h":50}
      },
      {
	     "filename": "mela_00019.png",
	     "frame": {"x":190,"y":100,"w":38,"h":50},
	     "rotated": false,
	     "trimmed": false,
	     "spriteSourceSize": {"x":0,"y":0,"w":38,"h":50},
	     "sourceSize": {"w":38,"h":50}
      },
      {
	     "filename": "mela_00020.png",
	     "frame": {"x":228,"y":100,"w":38,"h":50},
	     "rotated": false,
	     "trimmed": false,
	     "spriteSourceSize": {"x":0,"y":0,"w":38,"h":50},
	     "sourceSize": {"w":38,"h":50}
      },
      {
	     "filename": "mela_00021.png",
	     "frame": {"x":0,"y":150,"w":38,"h":50},
	     "rotated": false,
	     "trimmed": false,
	     "spriteSourceSize": {"x":0,"y":0,"w":38,"h":50},
	     "sourceSize": {"w":38,"h":50}
      },
      {
	     "filename": "mela_00022.png",
	     "frame": {"x":38,"y":150,"w":38,"h":50},
	     "rotated": false,
	     "trimmed": false,
	     "spriteSourceSize": {"x":0,"y":0,"w":38,"h":50},
	     "sourceSize": {"w":38,"h":50}
      },
      {
	     "filename": "mela_00023.png",
	     "frame": {"x":76,"y":150,"w":38,"h":50},
	     "rotated": false,
	     "trimmed": false,
	     "spriteSourceSize": {"x":0,"y":0,"w":38,"h":50},
	     "sourceSize": {"w":38,"h":50}
      },
      {
	     "filename": "mela_00024.png",
	     "frame": {"x":114,"y":150,"w":38,"h":50},
	     "rotated": false,
	     "trimmed": false,
	     "spriteSourceSize": {"x":0,"y":0,"w":38,"h":50},
	     "sourceSize": {"w":38,"h":50}
      },
      {
	     "filename": "mela_00025.png",
	     "frame": {"x":152,"y":150,"w":38,"h":50},
	     "rotated": false,
	     "trimmed": false,
	     "spriteSourceSize": {"x":0,"y":0,"w":38,"h":50},
	     "sourceSize": {"w":38,"h":50}
      },
      {
	     "filename": "mela_00026.png",
	     "frame": {"x":190,"y":150,"w":38,"h":50},
	     "rotated": false,
	     "trimmed": false,
	     "spriteSourceSize": {"x":0,"y":0,"w":38,"h":50},
	     "sourceSize": {"w":38,"h":50}
      },
      {
	     "filename": "mela_00027.png",
	     "frame": {"x":228,"y":150,"w":38,"h":50},
	     "rotated": false,
	     "trimmed": false,
	     "spriteSourceSize": {"x":0,"y":0,"w":38,"h":50},
	     "sourceSize": {"w":38,"h":50}
      },
      {
	     "filename": "mela_00028.png",
	     "frame": {"x":0,"y":200,"w":38,"h":50},
	     "rotated": false,
	     "trimmed": false,
	     "spriteSourceSize": {"x":0,"y":0,"w":38,"h":50},
	     "sourceSize": {"w":38,"h":50}
      },
      {
	     "filename": "mela_00029.png",
	     "frame": {"x":38,"y":200,"w":38,"h":50},
	     "rotated": false,
	     "trimmed": false,
	     "spriteSourceSize": {"x":0,"y":0,"w":38,"h":50},
	     "sourceSize": {"w":38,"h":50}
      },
      {
	     "filename": "mela_00030.png",
	     "frame": {"x":76,"y":200,"w":38,"h":50},
	     "rotated": false,
	     "trimmed": false,
	     "spriteSourceSize": {"x":0,"y":0,"w":38,"h":50},
	     "sourceSize": {"w":38,"h":50}
      },
      {
	     "filename": "mela_00031.png",
	     "frame": {"x":114,"y":200,"w":38,"h":50},
	     "rotated": false,
	     "trimmed": false,
	     "spriteSourceSize": {"x":0,"y":0,"w":38,"h":50},
	     "sourceSize": {"w":38,"h":50}
      },
      {
	     "filename": "mela_00032.png",
	     "frame": {"x":152,"y":200,"w":38,"h":50},
	     "rotated": false,
	     "trimmed": false,
	     "spriteSourceSize": {"x":0,"y":0,"w":38,"h":50},
	     "sourceSize": {"w":38,"h":50}
      },
      {
	     "filename": "mela_00033.png",
	     "frame": {"x":190,"y":200,"w":38,"h":50},
	     "rotated": false,
	     "trimmed": false,
	     "spriteSourceSize": {"x":0,"y":0,"w":38,"h":50},
	     "sourceSize": {"w":38,"h":50}
      },
      {
	     "filename": "mela_00034.png",
	     "frame": {"x":228,"y":200,"w":38,"h":50},
	     "rotated": false,
	     "trimmed": false,
	     "spriteSourceSize": {"x":0,"y":0,"w":38,"h":50},
	     "sourceSize": {"w":38,"h":50}
      },
      {
	     "filename": "mela_00035.png",
	     "frame": {"x":0,"y":250,"w":38,"h":50},
	     "rotated": false,
	     "trimmed": false,
	     "spriteSourceSize": {"x":0,"y":0,"w":38,"h":50},
	     "sourceSize": {"w":38,"h":50}
      },
      {
	     "filename": "mela_00036.png",
	     "frame": {"x":38,"y":250,"w":38,"h":50},
	     "rotated": false,
	     "trimmed": false,
	     "spriteSourceSize": {"x":0,"y":0,"w":38,"h":50},
	     "sourceSize": {"w":38,"h":50}
      },
      {
	     "filename": "mela_00037.png",
	     "frame": {"x":76,"y":250,"w":38,"h":50},
	     "rotated": false,
	     "trimmed": false,
	     "spriteSourceSize": {"x":0,"y":0,"w":38,"h":50},
	     "sourceSize": {"w":38,"h":50}
      },
      {
	     "filename": "mela_00038.png",
	     "frame": {"x":114,"y":250,"w":38,"h":50},
	     "rotated": false,
	     "trimmed": false,
	     "spriteSourceSize": {"x":0,"y":0,"w":38,"h":50},
	     "sourceSize": {"w":38,"h":50}
      },
      {
	     "filename": "mela_00039.png",
	     "frame": {"x":152,"y":250,"w":38,"h":50},
	     "rotated": false,
	     "trimmed": false,
	     "spriteSourceSize": {"x":0,"y":0,"w":38,"h":50},
	     "sourceSize": {"w":38,"h":50}
      }],
      "meta": {
	     "app": "https://www.codeandweb.com/texturepacker",
	     "version": "1.0",
	     "image": "mela.png",
	     "format": "RGBA8888",
	     "size": {"w":300,"h":300},
	     "scale": "1",
	     "smartupdate": "$TexturePacker:SmartUpdate:fe687e1ce4ad77833ef3aa8d86266031:15beef2bd9689b88079096a24614c555:68668cf06383ff459cccaafb6bf56215$"
      }
      };


      //correnti_anim
	    var animdata = {"frames": [

          {
	           "filename": "Correnti/Correnti_00000.png",
	            "frame": {"x":1149,"y":771,"w":285,"h":756},
	            "rotated": false,
	            "trimmed": true,
	            "spriteSourceSize": {"x":2,"y":12,"w":285,"h":756},
              "sourceSize": {"w":291,"h":768}
          },
          {
	           "filename": "Correnti/Correnti_00001.png",
	           "frame": {"x":1,"y":1,"w":285,"h":768},
	           "rotated": false,
	           "trimmed": true,
	           "spriteSourceSize": {"x":2,"y":0,"w":285,"h":768},
	           "sourceSize": {"w":291,"h":768}
          },
          {
	           "filename": "Correnti/Correnti_00002.png",
	           "frame": {"x":862,"y":771,"w":285,"h":762},
	           "rotated": false,
	           "trimmed": true,
	           "spriteSourceSize": {"x":2,"y":6,"w":285,"h":762},
	           "sourceSize": {"w":291,"h":768}
          },
          {
	           "filename": "Correnti/Correnti_00003.png",
	           "frame": {"x":1436,"y":771,"w":284,"h":768},
	           "rotated": false,
	           "trimmed": true,
	           "spriteSourceSize": {"x":3,"y":0,"w":284,"h":768},
	           "sourceSize": {"w":291,"h":768}
          },
          {
	           "filename": "Correnti/Correnti_00004.png",
	           "frame": {"x":1149,"y":1529,"w":284,"h":768},
	           "rotated": false,
	           "trimmed": true,
	           "spriteSourceSize": {"x":3,"y":0,"w":284,"h":768},
	           "sourceSize": {"w":291,"h":768}
          },
          {
	           "filename": "Correnti/Correnti_00005.png",
	           "frame": {"x":288,"y":1,"w":285,"h":768},
	           "rotated": false,
	           "trimmed": true,
	           "spriteSourceSize": {"x":2,"y":0,"w":285,"h":768},
	           "sourceSize": {"w":291,"h":768}
          },
          {
	           "filename": "Correnti/Correnti_00006.png",
	           "frame": {"x":575,"y":1,"w":285,"h":768},
	           "rotated": false,
	           "trimmed": true,
	           "spriteSourceSize": {"x":2,"y":0,"w":285,"h":768},
	           "sourceSize": {"w":291,"h":768}
          },
          {
	           "filename": "Correnti/Correnti_00007.png",
	           "frame": {"x":862,"y":1535,"w":284,"h":768},
	           "rotated": false,
	           "trimmed": true,
	           "spriteSourceSize": {"x":3,"y":0,"w":284,"h":768},
	           "sourceSize": {"w":291,"h":768}
          },
          {
	           "filename": "Correnti/Correnti_00008.png",
	           "frame": {"x":862,"y":1,"w":285,"h":768},
	           "rotated": false,
	           "trimmed": true,
             "spriteSourceSize": {"x":2,"y":0,"w":285,"h":768},
	           "sourceSize": {"w":291,"h":768}
          },
          {
	           "filename": "Correnti/Correnti_00009.png",
	            "frame": {"x":1722,"y":1541,"w":285,"h":734},
	            "rotated": false,
	            "trimmed": true,
	            "spriteSourceSize": {"x":2,"y":34,"w":285,"h":734},
	            "sourceSize": {"w":291,"h":768}
          },
          {
	           "filename": "Correnti/Correnti_00010.png",
	           "frame": {"x":1,"y":1541,"w":285,"h":754},
	           "rotated": false,
	           "trimmed": true,
	           "spriteSourceSize": {"x":2,"y":14,"w":285,"h":754},
	           "sourceSize": {"w":291,"h":768}
          },
          {
	           "filename": "Correnti/Correnti_00011.png",
	           "frame": {"x":1149,"y":1,"w":285,"h":768},
	           "rotated": false,
	           "trimmed": true,
	           "spriteSourceSize": {"x":2,"y":0,"w":285,"h":768},
	           "sourceSize": {"w":291,"h":768}
          },
          {
	           "filename": "Correnti/Correnti_00012.png",
	           "frame": {"x":288,"y":1541,"w":285,"h":754},
	           "rotated": false,
	           "trimmed": true,
	           "spriteSourceSize": {"x":2,"y":14,"w":285,"h":754},
	           "sourceSize": {"w":291,"h":768}
          },
          {
	           "filename": "Correnti/Correnti_00013.png",
	           "frame": {"x":1436,"y":1,"w":285,"h":768},
	           "rotated": false,
	           "trimmed": true,
	           "spriteSourceSize": {"x":2,"y":0,"w":285,"h":768},
	           "sourceSize": {"w":291,"h":768}
          },
          {
	           "filename": "Correnti/Correnti_00014.png",
	           "frame": {"x":1723,"y":1,"w":285,"h":768},
	           "rotated": false,
	           "trimmed": true,
	           "spriteSourceSize": {"x":2,"y":0,"w":285,"h":768},
	           "sourceSize": {"w":291,"h":768}
          },
          {
	           "filename": "Correnti/Correnti_00015.png",
	           "frame": {"x":2010,"y":1,"w":285,"h":768},
	           "rotated": false,
	           "trimmed": true,
	           "spriteSourceSize": {"x":2,"y":0,"w":285,"h":768},
	           "sourceSize": {"w":291,"h":768}
          },
          {
	           "filename": "Correnti/Correnti_00016.png",
	           "frame": {"x":1,"y":771,"w":285,"h":768},
	           "rotated": false,
	           "trimmed": true,
	           "spriteSourceSize": {"x":2,"y":0,"w":285,"h":768},
	           "sourceSize": {"w":291,"h":768}
          },
          {
	           "filename": "Correnti/Correnti_00017.png",
	           "frame": {"x":575,"y":1541,"w":284,"h":768},
	           "rotated": false,
	           "trimmed": true,
	           "spriteSourceSize": {"x":3,"y":0,"w":284,"h":768},
	           "sourceSize": {"w":291,"h":768}
          },
          {
	           "filename": "Correnti/Correnti_00018.png",
	           "frame": {"x":288,"y":771,"w":285,"h":768},
	           "rotated": false,
	           "trimmed": true,
	           "spriteSourceSize": {"x":2,"y":0,"w":285,"h":768},
	           "sourceSize": {"w":291,"h":768}
          },
          {
	           "filename": "Correnti/Correnti_00019.png",
	           "frame": {"x":575,"y":771,"w":285,"h":768},
	           "rotated": false,
	           "trimmed": true,
	           "spriteSourceSize": {"x":2,"y":0,"w":285,"h":768},
	           "sourceSize": {"w":291,"h":768}
          },
          {
	           "filename": "Correnti/Correnti_00020.png",
	           "frame": {"x":1722,"y":771,"w":284,"h":768},
	           "rotated": false,
	           "trimmed": true,
	           "spriteSourceSize": {"x":3,"y":0,"w":284,"h":768},
             "sourceSize": {"w":291,"h":768}
          },
          {
	           "filename": "Correnti/Correnti_00021.png",
	           "frame": {"x":2008,"y":771,"w":285,"h":734},
	           "rotated": false,
	           "trimmed": true,
	           "spriteSourceSize": {"x":2,"y":34,"w":285,"h":734},
	           "sourceSize": {"w":291,"h":768}
          },
          {
	           "filename": "Correnti/Correnti_00022.png",
	           "frame": {"x":1435,"y":1541,"w":285,"h":751},
	           "rotated": false,
	           "trimmed": true,
	           "spriteSourceSize": {"x":2,"y":17,"w":285,"h":751},
	           "sourceSize": {"w":291,"h":768}
          },
          {
	           "filename": "Correnti/Correnti_00023.png",
             "frame": {"x":2009,"y":1507,"w":284,"h":768},
	           "rotated": false,
	           "trimmed": true,
	           "spriteSourceSize": {"x":3,"y":0,"w":284,"h":768},
	           "sourceSize": {"w":291,"h":768}
          }],

          "meta": {
	           "app": "https://www.codeandweb.com/texturepacker",
	           "version": "1.0",
	           "image": "correnti.png",
	           "format": "RGBA8888",
	           "size": {"w":2310,"h":2310},
	           "scale": "1",
	           "smartupdate": "$TexturePacker:SmartUpdate:0bd5450f7ea34e3dd18675424e72c0f7:919bce5b0c587f28bf141e9b87847364:9662cc3b83c06b8225c3c39cd66b2d2a$"
          }
        };























      function create() {


        //comandi
              cursors = game.input.keyboard.createCursorKeys();
           jumpButton = game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR);
           fireButton = game.input.keyboard.addKey(Phaser.Keyboard.D);
            swap_male = game.input.keyboard.addKey(Phaser.Keyboard.Q);
          swap_female = game.input.keyboard.addKey(Phaser.Keyboard.E);
        abilityButton = game.input.keyboard.addKey(Phaser.Keyboard.A);
        bonfireButton = game.input.keyboard.addKey(Phaser.Keyboard.F);
          pauseButton = game.input.keyboard.addKey(Phaser.Keyboard.P);


        //camera_oggInvisibile
        camera_fix = game.add.sprite(25930, 0,'ogginvisibile');


        //muri_boss_room
        wall_1 = game.add.sprite(25400, 0, 'ogginvisibile');
        game.physics.arcade.enable(wall_1);
        wall_1.body.enable = false;
        wall_1.body.immovable = true;

        wall_2 = game.add.sprite(26430, 0, 'ogginvisibile');
        game.physics.arcade.enable(wall_2);
        wall_2.body.enable = false;
        wall_2.body.immovable = true;

        wall_3 = game.add.sprite(26165, -145, 'ogginvisibile');
        game.physics.arcade.enable(wall_3);
        wall_3.body.immovable = true;

        wall_4 = game.add.sprite(25400, 0, 'ogginvisibile');
        game.physics.arcade.enable(wall_4);
        wall_4.body.immovable = true;


        //world
        game.world.setBounds(0, 0, 30000, 768);
        background = game.add.image(0, 0, 'background');
        background_bosco_notturno = game.add.image(15137.683, 0, 'background_bosco_notturno');
        background_castello = game.add.image(15137.683 + 4750.280, 0, 'background_castello');
        luci_castello = game.add.image(15137.683 + 5170.280, 0, 'luci_castello');

        speed = 250;
        jump = 360;
        gravity = 500;
        velocity_fore = 0;
        air_velocity = 265;
        platform_velocity = 75;
        target_velocity = 140;

        apple_counter = 0;
        player_hp = 3;
        boss_hp = 6;

        l_bosco = 15137.683;
        l_bosco_notte = 5170.280;


        //contatori
        contatore_scene = 0;
        contatore_extra = 0;
        contatore_autori = 0;
        contatore_dialoghi = 1;


        //boolean
                         male = false;
                       female = true;
                        fermo = true;
                     dropbomb = true;
                        tempo = true;
                    copertina = true;
                         menu = false;
                mele_raccolte = false;
          istruzioni_visibili = true;

                  change_gate = false;
             inside_boss_room = false;
             start_boss_fight = false;
                 boss_is_down = false;
                     gameover = false;
               finale_normale = false;
                finale_felice = false;
          avvia_render_finale = false;
                rimani_aperto = false;
        rigenera_target_basso = false;
         rigenera_target_alto = false;
          timer_target_attivo = false;
           boss_start_dialogo = false;
        scorrimento_dialogo_i = false;
        scorrimento_dialogo_f = false;
             blocca_giocatore = false;
          variabili_giocatore = false;
              robin_atterrato = false;
            arrowloop_avviato = false;
               bomb_is_placed = false;
		        corrente_castello = false;


        //checkpoints_boolean
        checkpoint_1_status = false;
        checkpoint_2_status = false;
        checkpoint_3_status = false;
        checkpoint_4_status = false;
        checkpoint_5_status = false;


        //enemy_var
        enemy_speed = 75;
        enemy_1_oldposition = 0;
        enemy_2_oldposition = 0;
        enemy_3_oldposition = 0;
        enemy_4_oldposition = 0;
        enemy_5_oldposition = 0;
        enemy_6_oldposition = 0;
        enemy_7_oldposition = 0;
        enemy_8_oldposition = 0;


        //enemy_boolean
        enemy_1_down = false;
        enemy_2_down = false;
        enemy_3_down = false;
        enemy_4_down = false;
        enemy_5_down = false;
        enemy_6_down = false;
        enemy_7_down = false;
        enemy_8_down = false;


        //sign_messages
        cartello_1 = game.add.sprite(821, 641,'cartello');
        cartello_2 = game.add.sprite(1250, 641,'cartello');
        cartello_3 = game.add.sprite(2420, 542,'cartello');
        cartello_4 = game.add.sprite(3969, 542,'cartello');
        cartello_5 = game.add.sprite(4720, 132,'cartello');
        cartello_6 = game.add.sprite(6050, 369,'cartello');


        //lettera_chiusa
        lettera_chiusa = game.add.sprite(415, 700,'lettera_chiusa');


        //correnti_anim
        corrente_1 = game.add.sprite(4198, 0,'corrente');
        //corrente_2 = game.add.sprite(8532, 0,'corrente');
        //corrente_3 = game.add.sprite(8843, 0,'corrente');
        corrente_4 = game.add.sprite(9374, 0,'corrente');
        //corrente_5 = game.add.sprite(9684, 0,'corrente');
        corrente_6 = game.add.sprite(9993, 0,'corrente');
        corrente_7 = game.add.sprite(l_bosco + 1001, 0,'corrente');
        corrente_8 = game.add.sprite(l_bosco + 2410, 0,'corrente');
        corrente_9 = game.add.sprite(l_bosco + 2720, 0,'corrente');
        corrente_10 = game.add.sprite(l_bosco + 3030, 0,'corrente');
		    corrente_11 = game.add.sprite(l_bosco+l_bosco_notte + 4068, 770,'corrente');
		    game.physics.arcade.enable(corrente_11);


        corrente_1.animations.add('loop')
    		corrente_1.animations.play('loop', 35, true)
    		//corrente_2.animations.add('loop')
    		//corrente_2.animations.play('loop', 35, true)
    		//corrente_3.animations.add('loop')
    		//corrente_3.animations.play('loop', 35, true)
    		corrente_4.animations.add('loop')
    		corrente_4.animations.play('loop', 35, true)
    		//corrente_5.animations.add('loop')
    		//corrente_5.animations.play('loop', 35, true)
    		corrente_6.animations.add('loop')
    		corrente_6.animations.play('loop', 35, true)
    		corrente_7.animations.add('loop')
    		corrente_7.animations.play('loop', 35, true)
    		corrente_8.animations.add('loop')
    		corrente_8.animations.play('loop', 35, true)
    		corrente_9.animations.add('loop')
    		corrente_9.animations.play('loop', 35, true)
    		corrente_10.animations.add('loop')
    		corrente_10.animations.play('loop', 35, true)
		    corrente_11.animations.add('loop')
    		corrente_11.animations.play('loop', 35, true)


        //alberi
        albero_1 = game.add.sprite(1560, 735,'albero_1');
        albero_1.anchor.x = 0.3;
        albero_1.anchor.y = 1;
        game.physics.arcade.enable(albero_1);
        albero_1.body.immovable = true;
        albero_1.body.enable = false;

        albero_2 = game.add.sprite(5053, 207,'albero_2');
        game.physics.arcade.enable(albero_2);
        albero_2.body.immovable = true;
        albero_2.body.enable = true;
        albero_2.body.setSize(700, 75, 0, 15);


        //corda
        corda = game.add.sprite(5320, 0,'corda');
        game.physics.arcade.enable(corda);
        corda.body.immovable = true;

        //tutorial_freccia
        tutorial_freccia = game.add.sprite(5090, 110,'tutorial_freccia');
        game.physics.arcade.enable(tutorial_freccia);


        //Breakable environment
        blocco_1 = game.add.sprite(6111, 538,'blocco_1');
        game.physics.arcade.enable(blocco_1);
        blocco_1.body.immovable = true;

        blocco_2 = game.add.sprite(13677.857, 590.974, 'blocco_2');
        game.physics.arcade.enable(blocco_2);
        blocco_2.body.immovable = true;

		    blocco_3 = game.add.sprite(24450, 726, 'blocco_1');
        game.physics.arcade.enable(blocco_3);
        blocco_3.body.immovable = true;


        //rovi
        rovo_1 = game.add.sprite(l_bosco + 1289, 525, 'rovo_1');
        game.physics.arcade.enable(rovo_1);
        rovo_1.body.setSize(140, 50, 0, 0);
        rovo_1.body.immovable = true;

        rovo_2 = game.add.sprite(l_bosco + 1847, 717, 'rovo_2');
        game.physics.arcade.enable(rovo_2);
        rovo_2.body.setSize(290, 54, 0, 0);
        rovo_2.body.immovable = true;

        rovo_3_1 = game.add.sprite(l_bosco + 2246, -70, 'rovo_3');
        game.physics.arcade.enable(rovo_3_1);
        rovo_3_1.body.setSize(42, 258, 0, 0);
        rovo_3_1.body.immovable = true;

        rovo_3_2 = game.add.sprite(l_bosco + 2322, 0, 'rovo_3');
        game.physics.arcade.enable(rovo_3_2);
        rovo_3_2.body.setSize(42, 258, 0, 0);
        rovo_3_2.body.immovable = true;

        rovo_4 = game.add.sprite(l_bosco + 2689, -80, 'rovo_4');
        game.physics.arcade.enable(rovo_4);
        rovo_4.body.setSize(30, 344, 15, 0);
        rovo_4.body.immovable = true;

        rovo_5 = game.add.sprite(l_bosco + 2689, 438, 'rovo_5');
        game.physics.arcade.enable(rovo_5);
        rovo_5.body.setSize(30, 343, 15, 0);
        rovo_5.body.immovable = true;

        rovo_6 = game.add.sprite(l_bosco + 2983, -50, 'rovo_6');
        game.physics.arcade.enable(rovo_6);
        rovo_6.body.setSize(55, 475, 15, 0);
        rovo_6.body.immovable = true;

        rovo_7 = game.add.sprite(l_bosco + 2987, 604, 'rovo_7');
        game.physics.arcade.enable(rovo_7);
        rovo_7.body.setSize(40, 238, 15, 0);
        rovo_7.body.immovable = true;

        rovo_8 = game.add.sprite(l_bosco + 3280, 722, 'rovo_8');
        game.physics.arcade.enable(rovo_8);
        rovo_8.body.setSize(343, 57, 0, 0);
        rovo_8.body.immovable = true;


        //Cancello
        cancello = game.add.sprite(l_bosco + 659, 455, 'cancello');
        game.physics.arcade.enable(cancello);
        cancello.body.immovable = true;

        leva = game.add.sprite(l_bosco + 2246, 208.49, 'leva');
        game.physics.arcade.enable(leva);
        leva.body.immovable = true;
        leva.visible = true;

        leva_attivata = game.add.sprite(l_bosco + 2263, 208.49, 'leva_attivata');
        game.physics.arcade.enable(leva_attivata);
        leva_attivata.body.immovable = true;
        leva_attivata.visible = false;


        //door_boss_room
        cancello_boss_room = game.add.sprite(25340, 750, 'cancello');
        game.physics.arcade.enable(cancello_boss_room);
        cancello_boss_room.body.immovable = true;


        //boss_fight
        robin = game.add.sprite(26220, 285, 'robin');
        game.physics.arcade.enable(robin);

        robin.animations.add('robin_fermo_cattivo', [50], 20, true);
        robin.animations.add('robin_fermo_buono', [51], 20, true);
        robin.animations.add('robin_spara', [9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24], 50, false);
        robin.animations.add('robin_cammina', [26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49], 30, true)
        robin.animations.add('robin_confuso', [52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76], 20, false);
        robin.animations.play('robin_fermo_cattivo');


        cancello_boss_fight_1 = game.add.sprite(26165, 275, 'cancello_sopra');
        game.physics.arcade.enable(cancello_boss_fight_1);
        cancello_boss_fight_1.body.immovable = true;


        cancello_boss_fight_2 = game.add.sprite(26165, 607, 'cancello_sotto');
        game.physics.arcade.enable(cancello_boss_fight_2);
        cancello_boss_fight_2.body.immovable = true;


        ingranaggio_1 = game.add.sprite(26265 , 688, 'ingranaggio_1');
        game.physics.arcade.enable(ingranaggio_1);
        ingranaggio_1.anchor.x = 0.5;
        ingranaggio_1.anchor.y = 0.5;
        ingranaggio_1.body.angularVelocity = -65;
        ingranaggio_1.body.immovable = true;


        ingranaggio_2 = game.add.sprite(26330, 640, 'ingranaggio_2');
        game.physics.arcade.enable(ingranaggio_2);
        ingranaggio_2.anchor.x = 0.5;
        ingranaggio_2.anchor.y = 0.5;
        ingranaggio_2.body.angularVelocity = 75;
        ingranaggio_2.body.immovable = true;


        ingranaggio_3 = game.add.sprite(26250, 625, 'ingranaggio_3');
        game.physics.arcade.enable(ingranaggio_3);
        ingranaggio_3.anchor.x = 0.5;
        ingranaggio_3.anchor.y = 0.5;
        ingranaggio_3.body.angularVelocity = 50;
        ingranaggio_3.body.immovable = true;


        buco_frecce_2 = game.add.sprite(26175, 430, 'buco_frecce');
        game.physics.arcade.enable(buco_frecce_2);
        buco_frecce_2.body.immovable = true;


        buco_frecce_1 = game.add.sprite(26175, 550, 'buco_frecce');
        game.physics.arcade.enable(buco_frecce_1);
        buco_frecce_1.body.immovable = true;


        torre = game.add.sprite(26075, 234, 'torre');
        game.physics.arcade.enable(torre);
        torre.body.immovable = true;


        towerbullet_1 = game.add.weapon(5, 'femalebullet');
        towerbullet_1.trackSprite(buco_frecce_1, 45, 0);
        towerbullet_1.bulletGravity.y = 0;
        towerbullet_1.fireAngle = 180;
        towerbullet_1.bulletSpeed = 250;
        towerbullet_1.bulletKillType = Phaser.Weapon.KILL_CAMERA_BOUNDS;


        towerbullet_2 = game.add.weapon(5, 'femalebullet');
        towerbullet_2.trackSprite(buco_frecce_2, 45, 20);
        towerbullet_2.bulletGravity.y = 0;
        towerbullet_2.fireAngle = 180;
        towerbullet_2.bulletSpeed = 250;
        towerbullet_2.bulletKillType = Phaser.Weapon.KILL_CAMERA_BOUNDS;


        towerbullet_3 = game.add.weapon(5, 'femalebullet');
        towerbullet_3.trackSprite(robin, 0, 60);
        towerbullet_3.bulletGravity.y = 0;
        towerbullet_3.fireAngle = 180;
        towerbullet_3.bulletSpeed = 250;
        towerbullet_3.bulletKillType = Phaser.Weapon.KILL_CAMERA_BOUNDS;


        target_boss = game.add.sprite(26075, 220, 'bersaglio');
        game.physics.arcade.enable(target_boss);
        target_boss.visible = false;


        piattaforma_boss_1 = game.add.sprite(25765, 600, 'piattaforma1_boss_fight');
        game.physics.arcade.enable(piattaforma_boss_1);
        piattaforma_boss_1.body.immovable = true;
        piattaforma_boss_1.body.setSize(104, 20, 0, 0);
        piattaforma_boss_1.visible = false;


        piattaforma_boss_2 = game.add.sprite(25540, 480, 'piattaforma2_boss_fight');
        game.physics.arcade.enable(piattaforma_boss_2);
        piattaforma_boss_2.body.immovable = true;
        piattaforma_boss_2.body.setSize(104, 20, 0, 0);
        piattaforma_boss_2.visible = false;


        piattaforma_boss_3 = game.add.sprite(25775, 370, 'piattaforma3_boss_fight');
        game.physics.arcade.enable(piattaforma_boss_3);
        piattaforma_boss_3.body.immovable = true;
        piattaforma_boss_3.body.setSize(104, 20, 0, 0);
        piattaforma_boss_3.visible = false;








        //piattaforme
        piattaforma_1 = game.add.sprite(5050, 475,'piattaforma_1');
        game.physics.arcade.enable(piattaforma_1);
        piattaforma_1.body.setSize(190, 42, 0, 35);
        piattaforma_1.body.immovable = true;

        piattaforma_3 = game.add.sprite(8835, 465,'piattaforma_3');
        game.physics.arcade.enable(piattaforma_3);
        piattaforma_3.body.immovable = true;
        piattaforma_3.body.enable = false;
        piattaforma_3.anchor.x = 0.5;
        piattaforma_3.anchor.y = 0.5;

        piattaforma_6 = game.add.sprite(9100, 175,'piattaforma_6');
        game.physics.arcade.enable(piattaforma_6);
        piattaforma_6.body.immovable = true;

        piattaforma_4 = game.add.sprite(10397, 171,'piattaforma_4');
        game.physics.arcade.enable(piattaforma_4);
        piattaforma_4.body.immovable = true;
        piattaforma_4.body.velocity.y = platform_velocity;

        piattaforma_5 = game.add.sprite(11000, 250,'piattaforma_5');
        game.physics.arcade.enable(piattaforma_5);
        piattaforma_5.body.immovable = true;
        piattaforma_5.anchor.x = 0.5;
        piattaforma_5.anchor.y = 0.5;

        ramo_1 = game.add.sprite(11300, 342,'piattaforma_7_2');
        game.physics.arcade.enable(ramo_1);
        ramo_1.body.immovable = true;

        ramo_2 = game.add.sprite(11690, 306,'piattaforma_8');
        game.physics.arcade.enable(ramo_2);
        ramo_2.body.immovable = true;

        piattaforma_9 = game.add.sprite(11975, 610,'piattaforma_8_2');
        game.physics.arcade.enable(piattaforma_9);
        piattaforma_9.body.immovable = true;
        piattaforma_9.body.setSize(80, 10, 10, 0);

        piattaforma_10 = game.add.sprite(12235, 510,'piattaforma_10');
        game.physics.arcade.enable(piattaforma_10);
        piattaforma_10.body.immovable = true;
        piattaforma_10.body.setSize(290, 50, 10, 0);

        piattaforma_notte_fall_1 = game.add.sprite(l_bosco + 1895, 450, 'piattaforma_notte_8');
        game.physics.arcade.enable(piattaforma_notte_fall_1);
        piattaforma_notte_fall_1.body.immovable = true;

        piattaforma_notte_fall_2 = game.add.sprite(l_bosco + 2050, 370, 'piattaforma_notte_cade');
        game.physics.arcade.enable(piattaforma_notte_fall_2);
        piattaforma_notte_fall_2.body.immovable = true;

        piattaforma_notte_8 = game.add.sprite(l_bosco + 455, 505, 'piattaforma_notte_8');
        game.physics.arcade.enable(piattaforma_notte_8);
        piattaforma_notte_8.body.immovable = true;
        piattaforma_notte_8.body.setSize(104, 20, 0, 0);


        //bersagli
        target_1 = game.add.sprite(1511, 630,'bersaglio');
        game.physics.arcade.enable(target_1);

        target_2 = game.add.sprite(8797, 463,'bersaglio');
        game.physics.arcade.enable(target_2);

        target_3 = game.add.sprite(10950, 204,'bersaglio');
        game.physics.arcade.enable(target_3);
        target_3.body.velocity.x = -target_velocity;


        //floor
        floor = game.add.physicsGroup();
          floor.create(-8, 0, 'ogginvisibile');
          floor.create(-50, 726.028, 'platform1');
          floor.create(1011.463, 726.028, 'platform_a');
          floor.create(2051.151, 709.492, 'step1');
          floor.create(2090.053, 692.957, 'step2');
          floor.create(2128.956, 676.421, 'step3');
          floor.create(2167.858, 659.886, 'step4');
          floor.create(2206.761, 643.351, 'step5');
          floor.create(2244.664, 626.815, 'platform2');
          floor.create(3084.106, 626.815, 'platform_b');
          floor.create(3497.409, 626.815, 'platform_c');
          floor.create(4068.084, 578.751, 'stump1');
          floor.create(4500.387, 215.872, 'platform_d');
          floor.create(4500.387, 626.815, 'platform_e');
          floor.create(5738.875, 452.815, 'piattaforma_f_2');
          floor.create(6051.875, 452.815, 'muro_piattaforma_f');
          floor.create(5980.875, 540.815, 'gradino_piattaforma_f');
          floor.create(6204.780, 579.692, 'platform_g');
          floor.create(6251.614, 538.119, 'platform_h');
          floor.create(6377.203, 659.886, 'step6');
          floor.create(6495.466, 692.957, 'platform3');
          floor.create(7678.343, 623.828, 'platform_i');
          floor.create(7804.209, 552.496, 'platform_j');
          floor.create(8105.213, 552.496, 'platform_k');
          floor.create(9103.675, 552.496, 'platform_l');
          floor.create(11884.45, 726.028, 'platform4');
          floor.create(12519.318, 474.497, 'gradino_grotta_0');
          floor.create(12572.618, 514.958, 'gradino_grotta_1');
          floor.create(12613.452, 556.800, 'gradino_grotta_2');
          floor.create(12654.286, 598.641, 'gradino_grotta_3');
          floor.create(12695.121, 640.483, 'gradino_grotta_4');
          floor.create(12735.955, 682.325, 'gradino_grotta_5');

          floor.create(l_bosco, 726.028, 'piattaforma_notte_1');
          floor.create(l_bosco + 166.417, 693, 'piattaforma_notte_2');
          floor.create(l_bosco + 245.588, 660, 'piattaforma_notte_3');
          floor.create(l_bosco + 324.296, 627, 'piattaforma_notte_4');
          floor.create(l_bosco + 713.187, 660, 'piattaforma_notte_5');
          floor.create(l_bosco + 791.960, 692, 'piattaforma_notte_6');
          floor.create(l_bosco + 865, 726, 'piattaforma_notte_7'); //qui c' un bug di caduta (x.871)
          floor.create(l_bosco + 651, 414, 'piattaforma_notte_9');
          floor.create(l_bosco + 1286.077, 726, 'piattaforma_notte_10');
          floor.create(l_bosco + 1458.462, 534, 'piattaforma_notte_11');
          floor.create(l_bosco + 2134, 726, 'piattaforma_notte_12');
          floor.create(l_bosco + 1775, 275, 'piattaforma_notte_8');
          floor.create(l_bosco + 2250, 256, 'piattaforma_notte_14');
          floor.create(l_bosco + 3622.769, 726, 'piattaforma_notte_15');

          floor.create(l_bosco + l_bosco_notte, 726, 'piattaforma_castello_1');
		      floor.create(l_bosco + l_bosco_notte + 4280, 726, 'terra_castello_2');

        floor.setAll('body.immovable', true);





        //apple
		    apple_1 = game.add.sprite(1100,665,'mela');
		    apple_2 = game.add.sprite(1750,635,'mela');
		    apple_3 = game.add.sprite(3220,575,'mela');
		    apple_4 = game.add.sprite(4600,145,'mela');
		    apple_5 = game.add.sprite(5925,545,'mela');
		    apple_6 = game.add.sprite(6135,575,'mela');
		    apple_7 = game.add.sprite(9225,120,'mela');
		    apple_8 = game.add.sprite(12300,455,'mela');
		    apple_9 = game.add.sprite(13900,655,'mela');
		    apple_10 = game.add.sprite(15960,620,'mela');
		    apple_11 = game.add.sprite(16490,655,'mela');
		    apple_12 = game.add.sprite(17525,195,'mela');
		    apple_13 = game.add.sprite(17990,715,'mela');
		    apple_14 = game.add.sprite(18590,270,'mela');
		    apple_15 = game.add.sprite(24508,100,'mela');

		    game.physics.arcade.enable(apple_1);
		    game.physics.arcade.enable(apple_2);
		    game.physics.arcade.enable(apple_3);
		    game.physics.arcade.enable(apple_4);
		    game.physics.arcade.enable(apple_5);
		    game.physics.arcade.enable(apple_6);
		    game.physics.arcade.enable(apple_7);
		    game.physics.arcade.enable(apple_8);
		    game.physics.arcade.enable(apple_9);
		    game.physics.arcade.enable(apple_10);
		    game.physics.arcade.enable(apple_11);
		    game.physics.arcade.enable(apple_12);
		    game.physics.arcade.enable(apple_13);
		    game.physics.arcade.enable(apple_14);
		    game.physics.arcade.enable(apple_15);

		    apple_1.animations.add('melaloop');
        apple_1.animations.play('melaloop', 40, true);

        apple_2.animations.add('melaloop');
        apple_2.animations.play('melaloop', 40, true);

        apple_3.animations.add('melaloop');
  	    apple_3.animations.play('melaloop', 40, true);

        apple_4.animations.add('melaloop');
  	    apple_4.animations.play('melaloop', 40, true);

        apple_5.animations.add('melaloop');
  	    apple_5.animations.play('melaloop', 40, true);

        apple_6.animations.add('melaloop');
  	    apple_6.animations.play('melaloop', 40, true);

        apple_7.animations.add('melaloop');
  	    apple_7.animations.play('melaloop', 40, true);

        apple_8.animations.add('melaloop');
  	    apple_8.animations.play('melaloop', 40, true);

        apple_9.animations.add('melaloop');
  	    apple_9.animations.play('melaloop', 40, true);

        apple_10.animations.add('melaloop');
  	    apple_10.animations.play('melaloop', 40, true);

        apple_11.animations.add('melaloop');
  	    apple_11.animations.play('melaloop', 40, true);

        apple_12.animations.add('melaloop');
        apple_12.animations.play('melaloop', 40, true);

        apple_13.animations.add('melaloop');
  	    apple_13.animations.play('melaloop', 40, true);

        apple_14.animations.add('melaloop');
  	    apple_14.animations.play('melaloop', 40, true);

        apple_15.animations.add('melaloop');
        apple_15.animations.play('melaloop', 40, true);


        //checkpoints
        checkpoint_1 = game.add.sprite(300, 455, 'fuoco');
        checkpoint_1.animations.add('bonfire_off', [0], 20, true);
        checkpoint_1.animations.add('bonfire_lighting_up', [1,2,3,4,5,6,7,8,9], 9, false);
        checkpoint_1.animations.add('bonfire_up', [10,11,12,13,12,11], 6, true);
        checkpoint_1.animations.play('bonfire_off');
        checkpoint_1.visible = false;

        checkpoint_2 = game.add.sprite(6700, 420, 'fuoco');
        checkpoint_2.animations.add('bonfire_off', [0], 20, true);
        checkpoint_2.animations.add('bonfire_lighting_up', [1,2,3,4,5,6,7,8,9], 9, false);
        checkpoint_2.animations.add('bonfire_up', [10,11,12,13,12,11], 6, true);
        checkpoint_2.animations.play('bonfire_off');

        checkpoint_3 = game.add.sprite(14000, 455, 'fuoco');
        checkpoint_3.animations.add('bonfire_off', [0], 20, true);
        checkpoint_3.animations.add('bonfire_lighting_up', [1,2,3,4,5,6,7,8,9], 9, false);
        checkpoint_3.animations.add('bonfire_up', [10,11,12,13,12,11], 6, true);
        checkpoint_3.animations.play('bonfire_off');

        checkpoint_4 = game.add.sprite(18900, 455, 'fuoco');
        checkpoint_4.animations.add('bonfire_off', [0], 20, true);
        checkpoint_4.animations.add('bonfire_lighting_up', [1,2,3,4,5,6,7,8,9], 9, false);
        checkpoint_4.animations.add('bonfire_up', [10,11,12,13,12,11], 6, true);
        checkpoint_4.animations.play('bonfire_off');

        //checkpoint_boss_fight
        checkpoint_5 = game.add.sprite(24750, 455, 'fuoco');
        checkpoint_5.animations.add('bonfire_off', [0], 20, true);
        checkpoint_5.animations.add('bonfire_lighting_up', [1,2,3,4,5,6,7,8,9], 9, false);
        checkpoint_5.animations.add('bonfire_up', [10,11,12,13,12,11], 6, true);
        checkpoint_5.animations.play('bonfire_off');
        checkpoint_5.visible = false;


        //enemies
        enemy_1 = game.add.sprite(3085, 525, 'enemy');
        game.physics.arcade.enable(enemy_1);
        enemy_1.animations.add('arrowright', [0], 20, true);
        enemy_1.animations.add('arrowleft', [1], 20, true);
        enemy_1.animations.add('starleft', [2,3,4,5,6,7,8,9,10,11], 20, true);
        enemy_1.animations.add('enemyleft', [12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36], 20, true);
        enemy_1.animations.add('starright', [37,38,39,40,41,42,43,44,45,46], 20, true);
        enemy_1.animations.add('enemyright', [47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71], 20, true);
        enemy_1.body.velocity.x = enemy_speed;


        enemy_2 = game.add.sprite(5500, 525, 'enemy');
        game.physics.arcade.enable(enemy_2);
        enemy_2.animations.add('arrowright', [0], 20, true);
        enemy_2.animations.add('arrowleft', [1], 20, true);
        enemy_2.animations.add('starleft', [2,3,4,5,6,7,8,9,10,11], 20, true);
        enemy_2.animations.add('enemyleft', [12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36], 20, true);
        enemy_2.animations.add('starright', [37,38,39,40,41,42,43,44,45,46], 20, true);
        enemy_2.animations.add('enemyright', [47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71], 20, true);
        enemy_2.body.velocity.x = enemy_speed;


        enemy_3 = game.add.sprite(5350, 525, 'enemy');
        game.physics.arcade.enable(enemy_3);
        enemy_3.animations.add('arrowright', [0], 20, true);
        enemy_3.animations.add('arrowleft', [1], 20, true);
        enemy_3.animations.add('starleft', [2,3,4,5,6,7,8,9,10,11], 20, true);
        enemy_3.animations.add('enemyleft', [12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36], 20, true);
        enemy_3.animations.add('starright', [37,38,39,40,41,42,43,44,45,46], 20, true);
        enemy_3.animations.add('enemyright', [47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71], 20, true);
        enemy_3.body.velocity.x = enemy_speed;


        enemy_4 = game.add.sprite(7600, 590, 'enemy');
        game.physics.arcade.enable(enemy_4);
        enemy_4.animations.add('arrowright', [0], 20, true);
        enemy_4.animations.add('arrowleft', [1], 20, true);
        enemy_4.animations.add('starleft', [2,3,4,5,6,7,8,9,10,11], 20, true);
        enemy_4.animations.add('enemyleft', [12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36], 20, true);
        enemy_4.animations.add('starright', [37,38,39,40,41,42,43,44,45,46], 20, true);
        enemy_4.animations.add('enemyright', [47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71], 20, true);
        enemy_4.body.velocity.x = enemy_speed;


        enemy_5 = game.add.sprite(13600, 620, 'enemy');
        game.physics.arcade.enable(enemy_5);
        enemy_5.animations.add('arrowright', [0], 20, true);
        enemy_5.animations.add('arrowleft', [1], 20, true);
        enemy_5.animations.add('starleft', [2,3,4,5,6,7,8,9,10,11], 20, true);
        enemy_5.animations.add('enemyleft', [12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36], 20, true);
        enemy_5.animations.add('starright', [37,38,39,40,41,42,43,44,45,46], 20, true);
        enemy_5.animations.add('enemyright', [47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71], 20, true);
        enemy_5.body.velocity.x = enemy_speed;


        enemy_6 = game.add.sprite(13000, 620, 'enemy');
        game.physics.arcade.enable(enemy_6);
        enemy_6.animations.add('arrowright', [0], 20, true);
        enemy_6.animations.add('arrowleft', [1], 20, true);
        enemy_6.animations.add('starleft', [2,3,4,5,6,7,8,9,10,11], 20, true);
        enemy_6.animations.add('enemyleft', [12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36], 20, true);
        enemy_6.animations.add('starright', [37,38,39,40,41,42,43,44,45,46], 20, true);
        enemy_6.animations.add('enemyright', [47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71], 20, true);
        enemy_6.body.velocity.x = enemy_speed;


        enemy_7 = game.add.sprite(15775, 310, 'enemy');
        game.physics.arcade.enable(enemy_7);
        enemy_7.animations.add('arrowright', [0], 20, true);
        enemy_7.animations.add('arrowleft', [1], 20, true);
        enemy_7.animations.add('starleft', [2,3,4,5,6,7,8,9,10,11], 20, true);
        enemy_7.animations.add('enemyleft', [12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36], 20, true);
        enemy_7.animations.add('starright', [37,38,39,40,41,42,43,44,45,46], 20, true);
        enemy_7.animations.add('enemyright', [47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71], 20, true);
        enemy_7.body.velocity.x = enemy_speed;


        enemy_8 = game.add.sprite(16575, 430, 'enemy');
        game.physics.arcade.enable(enemy_8);
        enemy_8.animations.add('arrowright', [0], 20, true);
        enemy_8.animations.add('arrowleft', [1], 20, true);
        enemy_8.animations.add('starleft', [2,3,4,5,6,7,8,9,10,11], 20, true);
        enemy_8.animations.add('enemyleft', [12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36], 20, true);
        enemy_8.animations.add('starright', [37,38,39,40,41,42,43,44,45,46], 20, true);
        enemy_8.animations.add('enemyright', [47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71], 20, true);
        enemy_8.body.velocity.x = enemy_speed;


        //player
        player = game.add.sprite(25, 635, 'player');
        //player = game.add.sprite(24750, 635, 'player');  //giocatore_bossfight (commentate con // la riga sopra questa)
        game.physics.arcade.enable(player);
        player.body.gravity.y = gravity;
        player.body.collideWorldBounds = false;


        //player animation

        //Elizabeth
        player.animations.add('stoprightE', [26], 20, true);
        player.animations.add('stopleftE', [131], 20, true);
        player.animations.add('jumprightE', [78], 25, true);
        player.animations.add('jumpleftE', [105], 20, true);
        player.animations.add('caperightE', [25], 20, true);
        player.animations.add('capeleftE', [104], 20, true);
        player.animations.add('firerightE', [0,1,2,3,4,16,17,18,19,20,21,22], 45, true);
        player.animations.add('fireleftE', [106,107,108,109,121,122,123,124,125,126,127,128], 45, true);
        player.animations.add('rightE', [27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,51], 30, true);
        player.animations.add('leftE', [132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156], 30, true);

        //Gunther
        player.animations.add('stoprightG', [103], 20, true);
        player.animations.add('stopleftG', [207], 20, true);
        player.animations.add('jumprightG', [52], 25, true);
        player.animations.add('jumpleftG', [157], 20, true);
        player.animations.add('firerightG', [56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75], 80, true);
        player.animations.add('fireleftG', [161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180], 80, true);
        player.animations.add('rightG', [79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102], 30, true);
        player.animations.add('leftG', [183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206], 30, true);


        //gamestart
        player.animations.play('stoprightE');


        //camera
        game.camera.follow(player, Phaser.Camera.FOLLOW_LOCKON, 0.1, 0.1);


        //malebullet_right
        malebullet_right = game.add.weapon(5, 'malebullet');
        malebullet_right.trackSprite(player, 55, 35);
        malebullet_right.bulletGravity.y = 150;
        malebullet_right.fireAngle = -20;
        malebullet_right.bulletSpeed = 300;
        malebullet_right.bulletKillType = Phaser.Weapon.KILL_CAMERA_BOUNDS;


        //femalebullet_right
        femalebullet_right = game.add.weapon(5, 'femalebullet');
        femalebullet_right.trackSprite(player, 65, 50);
        femalebullet_right.fireAngle = 0;
        femalebullet_right.bulletSpeed = 500;
        femalebullet_right.bulletKillType = Phaser.Weapon.KILL_CAMERA_BOUNDS;


        //malebullet_left
        malebullet_left = game.add.weapon(5, 'malebullet');
        malebullet_left.trackSprite(player, 0, 35);
        malebullet_left.bulletGravity.y = 150;
        malebullet_left.fireAngle = -160;
        malebullet_left.bulletSpeed = 300;
        malebullet_left.bulletKillType = Phaser.Weapon.KILL_CAMERA_BOUNDS;


        //femalebullet_left
        femalebullet_left = game.add.weapon(5, 'femalebullet');
        femalebullet_left.trackSprite(player, 0, 50);
        femalebullet_left.fireAngle = 180;
        femalebullet_left.bulletSpeed = 500;
        femalebullet_left.bulletKillType = Phaser.Weapon.KILL_CAMERA_BOUNDS;


        //bomb
        bomb = game.add.weapon(1, 'bomb');
        bomb.trackSprite(player, 35, 50);
        bomb.bulletGravity.y = 100;
        bomb.fireAngle = 0;
        bomb.bulletSpeed = 0;
        bomb.bulletLifespan = 3000;
        bomb.bulletKillType = Phaser.Weapon.KILL_LIFESPAN;


        //stanza_segreta
        piattaforma_f_2 = game.add.sprite(5894.875, 452.815, 'piattaforma_f_2');
        game.physics.arcade.enable(piattaforma_f_2);
        piattaforma_f_2.body.immovable = true;
        piattaforma_f_2.body.enable = true;
        piattaforma_f_2.visible = true;


        //copertura_stanza_segreta
        copertura_piattaforma_f = game.add.image(5735.875, 452.815, 'copertura_piattaforma_f');
        copertura_piattaforma_f.visible = true;


        //muro_notte
        muro_notte = game.add.sprite(l_bosco + 933.889, 455.875, 'muro_notte');
        game.physics.arcade.enable(muro_notte);
        muro_notte.body.immovable = true;













        //foreground
        foreground = game.add.image(0, 0, 'foreground');


        //castello
        livello_regolazione_castello = game.add.image(l_bosco + l_bosco_notte - 420, 0, 'livello_regolazione_castello');


        //transizione_bosco_castello
        transizione_bosco_castello = game.add.image(l_bosco + 4259, -158, 'transizione_bosco_castello');












        //istruzioni
        istruzioni = game.add.image(0, 0, 'istruzioni');
        istruzioni.fixedToCamera = true;


        //pause_menu
        pause = game.add.image(50, 135, 'pausa');
        pause.fixedToCamera = true;


        //hud_hp
        hp_1_E = game.add.sprite(50, 50, 'hp_1_E');
        hp_2_E = game.add.sprite(50, 50, 'hp_2_E');
        hp_3_E = game.add.sprite(50, 50, 'hp_3_E');
        hp_1_G = game.add.sprite(50, 50, 'hp_1_G');
        hp_2_G = game.add.sprite(50, 50, 'hp_2_G');
        hp_3_G = game.add.sprite(50, 50, 'hp_3_G');

        hp_1_E.visible = false;
        hp_2_E.visible = false;
        hp_3_E.visible = false;
        hp_1_G.visible = false;
        hp_2_G.visible = false;

        hp_1_E.fixedToCamera = true;
        hp_2_E.fixedToCamera = true;
        hp_3_E.fixedToCamera = true;
        hp_1_G.fixedToCamera = true;
        hp_2_G.fixedToCamera = true;
        hp_3_G.fixedToCamera = true;


        //hud_apple_count
        n_00 = game.add.sprite(215, 130, 'n_00');
        n_01 = game.add.sprite(215, 130, 'n_01');
        n_02 = game.add.sprite(215, 130, 'n_02');
        n_03 = game.add.sprite(215, 130, 'n_03');
        n_04 = game.add.sprite(215, 130, 'n_04');
        n_05 = game.add.sprite(215, 130, 'n_05');
        n_06 = game.add.sprite(215, 130, 'n_06');
        n_07 = game.add.sprite(215, 130, 'n_07');
        n_08 = game.add.sprite(215, 130, 'n_08');
        n_09 = game.add.sprite(215, 130, 'n_09');
        n_10 = game.add.sprite(215, 130, 'n_10');
        n_11 = game.add.sprite(215, 130, 'n_11');
        n_12 = game.add.sprite(215, 130, 'n_12');
        n_13 = game.add.sprite(215, 130, 'n_13');
        n_14 = game.add.sprite(215, 130, 'n_14');
        n_15 = game.add.sprite(215, 130, 'n_15');

        n_00.visible = true;
        n_01.visible = false;
        n_02.visible = false;
        n_03.visible = false;
        n_04.visible = false;
        n_05.visible = false;
        n_06.visible = false;
        n_07.visible = false;
        n_08.visible = false;
        n_09.visible = false;
        n_10.visible = false;
        n_11.visible = false;
        n_12.visible = false;
        n_13.visible = false;
        n_14.visible = false;
        n_15.visible = false;

        n_00.fixedToCamera = true;
        n_01.fixedToCamera = true;
        n_02.fixedToCamera = true;
        n_03.fixedToCamera = true;
        n_04.fixedToCamera = true;
        n_05.fixedToCamera = true;
        n_06.fixedToCamera = true;
        n_07.fixedToCamera = true;
        n_08.fixedToCamera = true;
        n_09.fixedToCamera = true;
        n_10.fixedToCamera = true;
        n_11.fixedToCamera = true;
        n_12.fixedToCamera = true;
        n_13.fixedToCamera = true;
        n_14.fixedToCamera = true;
        n_15.fixedToCamera = true;


        //tutorial
        tutorial_1 = game.add.image(600, 400, 'tutorial_1');
        tutorial_2 = game.add.image(1030, 400, 'tutorial_2');
        tutorial_3 = game.add.image(2200, 300, 'tutorial_3');
        tutorial_4 = game.add.image(3750, 300, 'tutorial_4');
        tutorial_5 = game.add.image(4500, 230, 'tutorial_5');
        tutorial_6 = game.add.image(5832, 135, 'tutorial_6');
        tutorial_7 = game.add.image(0, 0, 'lettera_aperta');
        tutorial_7.fixedToCamera = true;
        tutorial_8 = game.add.image(6660, 350, 'tutorial_7');
        tutorial_9 = game.add.image(13960, 395, 'tutorial_8');
        tutorial_10 = game.add.image(18860, 395, 'tutorial_8');
        tutorial_11 = game.add.image(24710, 395, 'tutorial_8');

        tutorial_1.visible = false;
        tutorial_2.visible = false;
        tutorial_3.visible = false;
        tutorial_4.visible = false;
        tutorial_5.visible = false;
        tutorial_6.visible = false;
        tutorial_7.visible = false;
        tutorial_8.visible = false;
        tutorial_9.visible = false;
        tutorial_10.visible = false;
        tutorial_11.visible = false;


        //hud_boss_hp
        hp_0_R = game.add.sprite(715, 50, 'hp_0_R');
        hp_1_R = game.add.sprite(715, 50, 'hp_1_R');
        hp_2_R = game.add.sprite(715, 50, 'hp_2_R');
        hp_3_R = game.add.sprite(715, 50, 'hp_3_R');
        hp_4_R = game.add.sprite(715, 50, 'hp_4_R');
        hp_5_R = game.add.sprite(715, 50, 'hp_5_R');
        hp_6_R = game.add.sprite(715, 50, 'hp_6_R');

        hp_0_R.visible = false;
        hp_1_R.visible = false;
        hp_2_R.visible = false;
        hp_3_R.visible = false;
        hp_4_R.visible = false;
        hp_5_R.visible = false;
        hp_6_R.visible = false;

        hp_0_R.fixedToCamera = true;
        hp_1_R.fixedToCamera = true;
        hp_2_R.fixedToCamera = true;
        hp_3_R.fixedToCamera = true;
        hp_4_R.fixedToCamera = true;
        hp_5_R.fixedToCamera = true;
        hp_6_R.fixedToCamera = true;


        //barra_cutscene
        barra_cutscene = game.add.sprite(-100, -300, 'barra_cutscene');
        game.physics.arcade.enable(barra_cutscene);
        barra_cutscene.fixedToCamera = true;




















        //menu
        x1_riprendi = 570;
        x2_riprendi = 889;
        y1_riprendi = 377;
        y2_riprendi = 482;

        x1_torna_al_menu = 510;
        x2_torna_al_menu = 935;
        y1_torna_al_menu = 529;
        y2_torna_al_menu = 647;

        //gioca_con_noi
        x1_gioca_con_noi = 53;
        x2_gioca_con_noi = 313;
        y1_gioca_con_noi = 274;
        y2_gioca_con_noi = 341;

        //leggenda
        x1_leggenda = 63;
        x2_leggenda = 316;
        y1_leggenda = 370;
        y2_leggenda = 464;

        //autori
        x1_autori = 53;
        x2_autori = 313;
        y1_autori = 476;
        y2_autori = 546;

        //extra
        x1_extra = 115;
        x2_extra = 269;
        y1_extra = 563;
        y2_extra = 603;

        //back_to_copertina
        x1_back_to_copertina = 920;
        x2_back_to_copertina = 995;
        y1_back_to_copertina = 668;
        y2_back_to_copertina = 746;

        //freccia_sinistra
        x1_freccia_sinistra = 434;
        x2_freccia_sinistra = 512;
        y1_freccia_sinistra = 668;
        y2_freccia_sinistra = 746;

        //freccia_destra
        x1_freccia_destra = 512;
        x2_freccia_destra = 590;
        y1_freccia_destra = 668;
        y2_freccia_destra = 746;


        //copertina
        copertina_gioco = game.add.sprite(0, -2, 'copertina');
        copertina_gioco.fixedToCamera = true;
        copertina_gioco.visible = false;


        //autori_1
        autori_1 = game.add.sprite(0, 0, 'autori_1');
        autori_1.fixedToCamera = true;
        autori_1.visible = false;


        //render_storia1
        render_storia1 = game.add.sprite(0, 0, 'render_storia1');
        render_storia1.fixedToCamera = true;
        render_storia1.visible = false;

        //render_storia2
        render_storia2 = game.add.sprite(0, 0, 'render_storia2');
        render_storia2.fixedToCamera = true;
        render_storia2.visible = false;

        //render_storia3
        render_storia3 = game.add.sprite(0, 0, 'render_storia3');
        render_storia3.fixedToCamera = true;
        render_storia3.visible = false;

        //render_storia4
        render_storia4 = game.add.sprite(0, 0, 'render_storia4');
        render_storia4.fixedToCamera = true;
        render_storia4.visible = false;

        //render_storia5
        render_storia5 = game.add.sprite(0, 0, 'render_storia5');
        render_storia5.fixedToCamera = true;
        render_storia5.visible = false;

        //render_storia6
        render_storia6 = game.add.sprite(0, 0, 'render_storia6');
        render_storia6.fixedToCamera = true;
        render_storia6.visible = false;

        //render_storia7
        render_storia7 = game.add.sprite(0, 0, 'render_storia7');
        render_storia7.fixedToCamera = true;
        render_storia7.visible = false;

        //render_storia8
        render_storia8 = game.add.sprite(0, 0, 'render_storia8');
        render_storia8.fixedToCamera = true;
        render_storia8.visible = false;

        //render_storia8
        render_storia8 = game.add.sprite(0, 0, 'render_storia8');
        render_storia8.fixedToCamera = true;
        render_storia8.visible = false;

        //render_storia9
        render_storia9 = game.add.sprite(0, 0, 'render_storia9');
        render_storia9.fixedToCamera = true;
        render_storia9.visible = false;

        //render_storia10
        render_storia10 = game.add.sprite(0, 0, 'render_storia10');
        render_storia10.fixedToCamera = true;
        render_storia10.visible = false;

        //render_storia11
        render_storia11 = game.add.sprite(0, 0, 'render_storia11');
        render_storia11.fixedToCamera = true;
        render_storia11.visible = false;

        //render_storia12
        render_storia12 = game.add.sprite(0, 0, 'render_storia12');
        render_storia12.fixedToCamera = true;
        render_storia12.visible = false;

        //render_storia13
        render_storia13 = game.add.sprite(0, 0, 'render_storia13');
        render_storia13.fixedToCamera = true;
        render_storia13.visible = false;

        //render_storia14
        render_storia14 = game.add.sprite(0, 0, 'render_storia14');
        render_storia14.fixedToCamera = true;
        render_storia14.visible = false;

        //render_storia15
        render_storia15 = game.add.sprite(0, 0, 'render_storia15');
        render_storia15.fixedToCamera = true;
        render_storia15.visible = false;

        //render_finalefelice
        render_finalefelice = game.add.sprite(0, 0, 'render_finalefelice');
        render_finalefelice.fixedToCamera = true;
        render_finalefelice.visible = false;

        //render_finale
        render_finale = game.add.sprite(0, 0, 'render_finale');
        render_finale.fixedToCamera = true;
        render_finale.visible = false;

        //render_gameover
        render_gameover = game.add.sprite(0, 0, 'render_gameover');
        render_gameover.fixedToCamera = true;
        render_gameover.visible = false;


        //extra_1
        extra_1 = game.add.sprite(0, 0, 'extra_1');
        extra_1.fixedToCamera = true;
        extra_1.visible = false;

        //extra_2
        extra_2 = game.add.sprite(0, 0, 'extra_2');
        extra_2.fixedToCamera = true;
        extra_2.visible = false;

        //extra_3
        extra_3 = game.add.sprite(0, 0, 'extra_3');
        extra_3.fixedToCamera = true;
        extra_3.visible = false;

        //extra_4
        extra_4 = game.add.sprite(0, 0, 'extra_4');
        extra_4.fixedToCamera = true;
        extra_4.visible = false;

        //extra_5
        extra_5 = game.add.sprite(0, 0, 'extra_5');
        extra_5.fixedToCamera = true;
        extra_5.visible = false;

        //extra_6
        extra_6 = game.add.sprite(0, 0, 'extra_6');
        extra_6.fixedToCamera = true;
        extra_6.visible = false;

        //extra_7
        extra_7 = game.add.sprite(0, 0, 'extra_7');
        extra_7.fixedToCamera = true;
        extra_7.visible = false;

        //extra_8
        extra_8 = game.add.sprite(0, 0, 'extra_8');
        extra_8.fixedToCamera = true;
        extra_8.visible = false;


        //dialogo_finale1
        dialogo_finale1 = game.add.sprite(325, 505, 'dialogo_finale1');
        dialogo_finale1.fixedToCamera = true;
        dialogo_finale1.visible = false;

        //dialogo_finale2
        dialogo_finale2 = game.add.sprite(480, 250, 'dialogo_finale2');
        dialogo_finale2.fixedToCamera = true;
        dialogo_finale2.visible = false;

        //dialogo_finale3
        dialogo_finale3 = game.add.sprite(295, 430, 'dialogo_finale3');
        dialogo_finale3.fixedToCamera = true;
        dialogo_finale3.visible = false;

        //dialogo_finale4
        dialogo_finale4 = game.add.sprite(480, 235, 'dialogo_finale4');
        dialogo_finale4.fixedToCamera = true;
        dialogo_finale4.visible = false;

        //dialogo_finale5
        dialogo_finale5 = game.add.sprite(295, 453, 'dialogo_finale5');
        dialogo_finale5.fixedToCamera = true;
        dialogo_finale5.visible = false;

        //dialogo_finale6
        dialogo_finale6 = game.add.sprite(504, 266, 'dialogo_finale6');
        dialogo_finale6.fixedToCamera = true;
        dialogo_finale6.visible = false;

        //dialogo_finale7
        dialogo_finale7 = game.add.sprite(550, 390, 'dialogo_finale7');
        dialogo_finale7.fixedToCamera = true;
        dialogo_finale7.visible = false;

        //dialogo_finale8
        dialogo_finale8 = game.add.sprite(550, 390, 'dialogo_finale8');
        dialogo_finale8.fixedToCamera = true;
        dialogo_finale8.visible = false;

        //Salta_dialogo
        salta_dialogo = game.add.sprite(902, 162, 'salta');
        salta_dialogo.fixedToCamera = true;
        salta_dialogo.visible = false;


        //game_start
        copertina_gioco.visible = true;
        game.paused = true;



        game.input.onDown.add(unpause, self);
        function unpause(event) {

          //gioca_con_noi
          if ( ((event.x > x1_gioca_con_noi && event.x < x2_gioca_con_noi) && (event.y > y1_gioca_con_noi && event.y < y2_gioca_con_noi)) && copertina == true ) {
              game.paused = false;
              copertina = false;

              contatore_scene = 0;
              contatore_extra = 0;
              contatore_autori = 0;
              contatore_dialoghi = 1;

              copertina_gioco.visible = false;


            //riprendi
            } else if ( ((event.x > x1_riprendi && event.x < x2_riprendi) && (event.y > y1_riprendi && event.y < y2_riprendi)) && menu == true ) {
                menu = false;
                menu_pausa.visible = false;
                game.paused = false;


            //torna_al_menu
            } else if ( ((event.x > x1_torna_al_menu && event.x < x2_torna_al_menu) && (event.y > y1_torna_al_menu && event.y < y2_torna_al_menu)) && menu == true ) {
                game.paused = false;
                game.state.restart();


            //gameover
            } else if ( ((event.x > 0 && event.x < 1024) && (event.y > 0 && event.y < 768)) && gameover == true ) {
                gameover = false;
                render_gameover.visible = false;
                game.paused = false;

                hp_6_R.visible = false;
                hp_5_R.visible = false;
                hp_4_R.visible = false;
                hp_3_R.visible = false;
                hp_2_R.visible = false;
                hp_1_R.visible = false;
                hp_0_R.visible = false;

                player.x = last_checkpoint_x + 250;
                player.y = last_checkpoint_y + 125;

                game.camera.follow(player, Phaser.Camera.FOLLOW_LOCKON, 0.1, 0.1);

                cancello_boss_fight_2.y = 607;
                cancello_boss_fight_1.y = 275;
                cancello_boss_room.y = 750;

                change_gate = false;
                inside_boss_room = false;
                start_boss_fight = false;
                rimani_aperto = false;

                wall_1.body.enable = false;
                wall_2.body.enable = false;

                player_hp = 3;
                boss_hp = 6;

                contatore_dialoghi = 1;


            //finale
            } else if ( ((event.x > x1_freccia_destra && event.x < x2_freccia_destra) && (event.y > y1_freccia_destra && event.y < y2_freccia_destra)) && finale_normale == true ) {
                finale_normale = false;
                render_finale.visible = false;
                if (mele_raccolte == false) {
                  game.paused = false;
                  game.state.restart();
                }


            //finalefelice
            } else if ( ((event.x > x1_freccia_destra && event.x < x2_freccia_destra) && (event.y > y1_freccia_destra && event.y < y2_freccia_destra)) && finale_felice == true ) {
                finale_felice = false;
                render_finalefelice.visible = false;
                game.paused = false;
                game.state.restart();


            //back_to_copertina
            } else if ( ((event.x > x1_back_to_copertina && event.x < x2_back_to_copertina) && (event.y > y1_back_to_copertina && event.y < y2_back_to_copertina)) &&
                      (contatore_scene != 0 || contatore_extra != 0 || contatore_autori != 0) ) {

                copertina = true;

                copertina_gioco.visible = true;

                contatore_scene = 0;
                contatore_extra = 0;
                contatore_autori = 0;

                // TODO: tutte le scene, gli extra e gli autori devono essere inseriti con visibilit false
                autori_1.visible = false;
                render_storia1.visible = false;
                render_storia2.visible = false;
                render_storia3.visible = false;
                render_storia4.visible = false;
                render_storia5.visible = false;
                render_storia6.visible = false;
                render_storia7.visible = false;
                render_storia8.visible = false;
                render_storia9.visible = false;
                render_storia10.visible = false;
                render_storia11.visible = false;
                render_storia12.visible = false;
                render_storia13.visible = false;
                render_storia14.visible = false;
                render_storia15.visible = false;
                extra_1.visible = false;
                extra_2.visible = false;
                extra_3.visible = false;
                extra_4.visible = false;
                extra_5.visible = false;
                extra_6.visible = false;
                extra_7.visible = false;
                extra_8.visible = false;


            //crediti_+_autori_1
            } else if ( ((event.x > x1_autori && event.x < x2_autori) && (event.y > y1_autori && event.y < y2_autori)) && copertina == true ) {
                copertina = false;
                autori_1.visible = true;
                contatore_autori = 1;

                copertina_gioco.visible = false;


            //leggenda_+_render_storia1
            } else if ( ((event.x > x1_leggenda && event.x < x2_leggenda) && (event.y > y1_leggenda && event.y < y2_leggenda)) && copertina == true) {
                copertina = false;
                render_storia1.visible = true;
                contatore_scene = 1;

                copertina_gioco.visible = false;


            //render_storia2
            } else if ( ((event.x > x1_freccia_destra && event.x < x2_freccia_destra) && (event.y > y1_freccia_destra && event.y < y2_freccia_destra)) && contatore_scene == 1 ) {
                render_storia2.visible = true;
                contatore_scene = 2;

                render_storia1.visible = false;

            } else if ( ((event.x > x1_freccia_sinistra && event.x < x2_freccia_sinistra) && (event.y > y1_freccia_sinistra && event.y < y2_freccia_sinistra)) && contatore_scene == 2 ) {
                render_storia1.visible = true;
                contatore_scene = 1;

                render_storia2.visible = false;

            //render_storia3
            } else if ( ((event.x > x1_freccia_destra && event.x < x2_freccia_destra) && (event.y > y1_freccia_destra && event.y < y2_freccia_destra)) && contatore_scene == 2 ) {
                render_storia3.visible = true;
                contatore_scene = 3;

                render_storia2.visible = false;

            } else if ( ((event.x > x1_freccia_sinistra && event.x < x2_freccia_sinistra) && (event.y > y1_freccia_sinistra && event.y < y2_freccia_sinistra)) && contatore_scene == 3 ) {
                render_storia2.visible = true;
                contatore_scene = 2;

                render_storia3.visible = false;

            //render_storia4
            } else if ( ((event.x > x1_freccia_destra && event.x < x2_freccia_destra) && (event.y > y1_freccia_destra && event.y < y2_freccia_destra)) && contatore_scene == 3 ) {
                render_storia4.visible = true;
                contatore_scene = 4;

                render_storia3.visible = false;

            } else if ( ((event.x > x1_freccia_sinistra && event.x < x2_freccia_sinistra) && (event.y > y1_freccia_sinistra && event.y < y2_freccia_sinistra)) && contatore_scene == 4 ) {
                render_storia3.visible = true;
                contatore_scene = 3;

                render_storia4.visible = false;

            //render_storia5
            } else if ( ((event.x > x1_freccia_destra && event.x < x2_freccia_destra) && (event.y > y1_freccia_destra && event.y < y2_freccia_destra)) && contatore_scene == 4 ) {
                render_storia5.visible = true;
                contatore_scene = 5;

                render_storia4.visible = false;

            } else if ( ((event.x > x1_freccia_sinistra && event.x < x2_freccia_sinistra) && (event.y > y1_freccia_sinistra && event.y < y2_freccia_sinistra)) && contatore_scene == 5 ) {
                render_storia4.visible = true;
                contatore_scene = 4;

                render_storia5.visible = false;

            //render_storia6
            } else if ( ((event.x > x1_freccia_destra && event.x < x2_freccia_destra) && (event.y > y1_freccia_destra && event.y < y2_freccia_destra)) && contatore_scene == 5 ) {
                render_storia6.visible = true;
                contatore_scene = 6;

                render_storia5.visible = false;

            } else if ( ((event.x > x1_freccia_sinistra && event.x < x2_freccia_sinistra) && (event.y > y1_freccia_sinistra && event.y < y2_freccia_sinistra)) && contatore_scene == 6 ) {
                render_storia5.visible = true;
                contatore_scene = 5;

                render_storia6.visible = false;

            //render_storia7
            } else if ( ((event.x > x1_freccia_destra && event.x < x2_freccia_destra) && (event.y > y1_freccia_destra && event.y < y2_freccia_destra)) && contatore_scene == 6 ) {
                render_storia7.visible = true;
                contatore_scene = 7;

                render_storia6.visible = false;

            } else if ( ((event.x > x1_freccia_sinistra && event.x < x2_freccia_sinistra) && (event.y > y1_freccia_sinistra && event.y < y2_freccia_sinistra)) && contatore_scene == 7 ) {
                render_storia6.visible = true;
                contatore_scene = 6;

                render_storia7.visible = false;

            //render_storia8
            } else if ( ((event.x > x1_freccia_destra && event.x < x2_freccia_destra) && (event.y > y1_freccia_destra && event.y < y2_freccia_destra)) && contatore_scene == 7 ) {
                render_storia8.visible = true;
                contatore_scene = 8;

                render_storia7.visible = false;

            } else if ( ((event.x > x1_freccia_sinistra && event.x < x2_freccia_sinistra) && (event.y > y1_freccia_sinistra && event.y < y2_freccia_sinistra)) && contatore_scene == 8 ) {
                render_storia7.visible = true;
                contatore_scene = 7;

                render_storia8.visible = false;

            //render_storia9
            } else if ( ((event.x > x1_freccia_destra && event.x < x2_freccia_destra) && (event.y > y1_freccia_destra && event.y < y2_freccia_destra)) && contatore_scene == 8 ) {
                render_storia9.visible = true;
                contatore_scene = 9;

                render_storia8.visible = false;

            } else if ( ((event.x > x1_freccia_sinistra && event.x < x2_freccia_sinistra) && (event.y > y1_freccia_sinistra && event.y < y2_freccia_sinistra)) && contatore_scene == 9 ) {
                render_storia8.visible = true;
                contatore_scene = 8;

                render_storia9.visible = false;

            //render_storia10
            } else if ( ((event.x > x1_freccia_destra && event.x < x2_freccia_destra) && (event.y > y1_freccia_destra && event.y < y2_freccia_destra)) && contatore_scene == 9 ) {
                render_storia10.visible = true;
                contatore_scene = 10;

                render_storia9.visible = false;

            } else if ( ((event.x > x1_freccia_sinistra && event.x < x2_freccia_sinistra) && (event.y > y1_freccia_sinistra && event.y < y2_freccia_sinistra)) && contatore_scene == 10 ) {
                render_storia9.visible = true;
                contatore_scene = 9;

                render_storia10.visible = false;

            //render_storia11
            } else if ( ((event.x > x1_freccia_destra && event.x < x2_freccia_destra) && (event.y > y1_freccia_destra && event.y < y2_freccia_destra)) && contatore_scene == 10 ) {
                render_storia11.visible = true;
                contatore_scene = 11;

                render_storia10.visible = false;

            } else if ( ((event.x > x1_freccia_sinistra && event.x < x2_freccia_sinistra) && (event.y > y1_freccia_sinistra && event.y < y2_freccia_sinistra)) && contatore_scene == 11 ) {
                render_storia10.visible = true;
                contatore_scene = 10;

                render_storia11.visible = false;

            //render_storia12
            } else if ( ((event.x > x1_freccia_destra && event.x < x2_freccia_destra) && (event.y > y1_freccia_destra && event.y < y2_freccia_destra)) && contatore_scene == 11 ) {
                render_storia12.visible = true;
                contatore_scene = 12;

                render_storia11.visible = false;

            } else if ( ((event.x > x1_freccia_sinistra && event.x < x2_freccia_sinistra) && (event.y > y1_freccia_sinistra && event.y < y2_freccia_sinistra)) && contatore_scene == 12 ) {
                render_storia11.visible = true;
                contatore_scene = 11;

                render_storia12.visible = false;

            //render_storia13
            } else if ( ((event.x > x1_freccia_destra && event.x < x2_freccia_destra) && (event.y > y1_freccia_destra && event.y < y2_freccia_destra)) && contatore_scene == 12 ) {
                render_storia13.visible = true;
                contatore_scene = 13;

                render_storia12.visible = false;

            } else if ( ((event.x > x1_freccia_sinistra && event.x < x2_freccia_sinistra) && (event.y > y1_freccia_sinistra && event.y < y2_freccia_sinistra)) && contatore_scene == 13 ) {
                render_storia12.visible = true;
                contatore_scene = 12;

                render_storia13.visible = false;

            //render_storia14
            } else if ( ((event.x > x1_freccia_destra && event.x < x2_freccia_destra) && (event.y > y1_freccia_destra && event.y < y2_freccia_destra)) && contatore_scene == 13 ) {
                render_storia14.visible = true;
                contatore_scene = 14;

                render_storia13.visible = false;

            } else if ( ((event.x > x1_freccia_sinistra && event.x < x2_freccia_sinistra) && (event.y > y1_freccia_sinistra && event.y < y2_freccia_sinistra)) && contatore_scene == 14 ) {
                render_storia13.visible = true;
                contatore_scene = 13;

                render_storia14.visible = false;

            //render_storia15
            } else if ( ((event.x > x1_freccia_destra && event.x < x2_freccia_destra) && (event.y > y1_freccia_destra && event.y < y2_freccia_destra)) && contatore_scene == 14 ) {
                render_storia15.visible = true;
                contatore_scene = 15;

                render_storia14.visible = false;

            } else if ( ((event.x > x1_freccia_destra && event.x < x2_freccia_destra) && (event.y > y1_freccia_destra && event.y < y2_freccia_destra)) && contatore_scene == 15 ) {
                render_storia15.visible = false;

                game.paused = false;

                copertina_gioco.visible = false;

                contatore_scene = 0;
                contatore_extra = 0;
                contatore_autori = 0;

            } else if ( ((event.x > x1_freccia_sinistra && event.x < x2_freccia_sinistra) && (event.y > y1_freccia_sinistra && event.y < y2_freccia_sinistra)) && contatore_scene == 15 ) {
                render_storia14.visible = true;
                contatore_scene = 14;

                render_storia15.visible = false;


            //extra_+_extra_1
            } else if ( ((event.x > x1_extra && event.x < x2_extra) && (event.y > y1_extra && event.y < y2_extra)) && copertina == true ) {
                copertina = false;
                extra_1.visible = true;
                contatore_extra = 1;

                copertina_gioco.visible = false;

            //extra_2
            } else if ( ((event.x > x1_freccia_destra && event.x < x2_freccia_destra) && (event.y > y1_freccia_destra && event.y < y2_freccia_destra)) && contatore_extra == 1 ) {
                extra_2.visible = true;
                contatore_extra = 2;

                extra_1.visible = false;

            } else if ( ((event.x > x1_freccia_sinistra && event.x < x2_freccia_sinistra) && (event.y > y1_freccia_sinistra && event.y < y2_freccia_sinistra)) && contatore_extra == 2 ) {
                extra_1.visible = true;
                contatore_extra = 1;

                extra_2.visible = false;

            //extra_3
            } else if ( ((event.x > x1_freccia_destra && event.x < x2_freccia_destra) && (event.y > y1_freccia_destra && event.y < y2_freccia_destra)) && contatore_extra == 2 ) {
                extra_3.visible = true;
                contatore_extra = 3;

                extra_2.visible = false;

            } else if ( ((event.x > x1_freccia_sinistra && event.x < x2_freccia_sinistra) && (event.y > y1_freccia_sinistra && event.y < y2_freccia_sinistra)) && contatore_extra == 3 ) {
                extra_2.visible = true;
                contatore_extra = 2;

                extra_3.visible = false;

            //extra_4
            } else if ( ((event.x > x1_freccia_destra && event.x < x2_freccia_destra) && (event.y > y1_freccia_destra && event.y < y2_freccia_destra)) && contatore_extra == 3 ) {
                extra_4.visible = true;
                contatore_extra = 4;

                extra_3.visible = false;

            } else if ( ((event.x > x1_freccia_sinistra && event.x < x2_freccia_sinistra) && (event.y > y1_freccia_sinistra && event.y < y2_freccia_sinistra)) && contatore_extra == 4 ) {
                extra_3.visible = true;
                contatore_extra = 3;

                extra_4.visible = false;

            //extra_5
            } else if ( ((event.x > x1_freccia_destra && event.x < x2_freccia_destra) && (event.y > y1_freccia_destra && event.y < y2_freccia_destra)) && contatore_extra == 4 ) {
                extra_5.visible = true;
                contatore_extra = 5;

                extra_4.visible = false;

            } else if ( ((event.x > x1_freccia_sinistra && event.x < x2_freccia_sinistra) && (event.y > y1_freccia_sinistra && event.y < y2_freccia_sinistra)) && contatore_extra == 5 ) {
                extra_4.visible = true;
                contatore_extra = 4;

                extra_5.visible = false;

            //extra_6
            } else if ( ((event.x > x1_freccia_destra && event.x < x2_freccia_destra) && (event.y > y1_freccia_destra && event.y < y2_freccia_destra)) && contatore_extra == 5 ) {
                extra_6.visible = true;
                contatore_extra = 6;

                extra_5.visible = false;

            } else if ( ((event.x > x1_freccia_sinistra && event.x < x2_freccia_sinistra) && (event.y > y1_freccia_sinistra && event.y < y2_freccia_sinistra)) && contatore_extra == 6 ) {
                extra_5.visible = true;
                contatore_extra = 5;

                extra_6.visible = false;

            //extra_7
            } else if ( ((event.x > x1_freccia_destra && event.x < x2_freccia_destra) && (event.y > y1_freccia_destra && event.y < y2_freccia_destra)) && contatore_extra == 6 ) {
                extra_7.visible = true;
                contatore_extra = 7;

                extra_6.visible = false;

            } else if ( ((event.x > x1_freccia_sinistra && event.x < x2_freccia_sinistra) && (event.y > y1_freccia_sinistra && event.y < y2_freccia_sinistra)) && contatore_extra == 7 ) {
                extra_6.visible = true;
                contatore_extra = 6;

                extra_7.visible = false;

            //extra_8
            } else if ( ((event.x > x1_freccia_destra && event.x < x2_freccia_destra) && (event.y > y1_freccia_destra && event.y < y2_freccia_destra)) && contatore_extra == 7 ) {
                extra_8.visible = true;
                contatore_extra = 8;

                extra_7.visible = false;

            } else if ( ((event.x > x1_freccia_sinistra && event.x < x2_freccia_sinistra) && (event.y > y1_freccia_sinistra && event.y < y2_freccia_sinistra)) && contatore_extra == 8 ) {
                extra_7.visible = true;
                contatore_extra = 7;

                extra_8.visible = false;


            //dialogo_finale
            } else if ( ((event.x > 325 && event.x < 505) && (event.y > 505 && event.y < 626)) && scorrimento_dialogo_i == true && contatore_dialoghi == 1 ) {

                dialogo_finale1.visible = false;
                contatore_dialoghi = 2;

                dialogo_finale2.visible = true;

            } else if ( ((event.x > 480 && event.x < 750) && (event.y > 250 && event.y < 410)) && contatore_dialoghi == 2 ) {
                dialogo_finale2.visible = false;
                contatore_dialoghi = 3;

                dialogo_finale3.visible = true;

            } else if ( ((event.x > 295 && event.x < 295+237) && (event.y > 430 && event.y < 430+196)) && contatore_dialoghi == 3 ) {
                dialogo_finale3.visible = false;
                contatore_dialoghi = 4;

                dialogo_finale4.visible = true;

            } else if ( ((event.x > 480 && event.x < 480+272) && (event.y > 235 && event.y < 235+195)) && contatore_dialoghi == 4 ) {
                dialogo_finale4.visible = false;
                contatore_dialoghi = 5;

                dialogo_finale5.visible = true;

            } else if ( ((event.x > 295 && event.x < 295+236) && (event.y > 453 && event.y < 453+172)) && contatore_dialoghi == 5 ) {
                dialogo_finale5.visible = false;
                contatore_dialoghi = 6;

                dialogo_finale6.visible = true;

            } else if ( ((event.x > 504 && event.x < 504+248) && (event.y > 266 && event.y < 266+137)) && contatore_dialoghi == 6 ) {
                scorrimento_dialogo_i = false;
                salta_dialogo.visible = false;
                dialogo_finale6.visible = false;
                contatore_dialoghi = 7;

                hp_6_R.visible = true;

                barra_cutscene.visible = false;

                start_boss_fight = true;
                game.paused = false;

            } else if ( ((event.x > 890 && event.x < 1000) && (event.y > 150 && event.y < 200)) && scorrimento_dialogo_i == true ) {
                scorrimento_dialogo_i = false;
                salta_dialogo.visible = false;
                dialogo_finale1.visible = false;
                dialogo_finale2.visible = false;
                dialogo_finale3.visible = false;
                dialogo_finale4.visible = false;
                dialogo_finale5.visible = false;
                dialogo_finale6.visible = false;
                contatore_dialoghi = 7;

                hp_6_R.visible = true;

                barra_cutscene.visible = false;

                start_boss_fight = true;
                game.paused = false;

            } else if ( ((event.x > 550 && event.x < 550+237) && (event.y > 390 && event.y < 390+230)) && scorrimento_dialogo_f ==  true ) {
                scorrimento_dialogo_f = false;
                dialogo_finale7.visible = false;
                contatore_dialoghi = 8;

                dialogo_finale8.visible = true;

            } else if ( ((event.x > 550 && event.x < 550+237) && (event.y > 390 && event.y < 390+230)) && contatore_dialoghi ==  8 ) {
                dialogo_finale8.visible = false;
                contatore_dialoghi = 1;

                finale_normale = true;
                game.paused = false;

            }


        };




      }

























      function update() {


        //player1
        game.physics.arcade.collide(player, floor);

		    game.physics.arcade.collide(player, apple_1, apple_count_up);
		    game.physics.arcade.collide(player, apple_2, apple_count_up);
		    game.physics.arcade.collide(player, apple_3, apple_count_up);
		    game.physics.arcade.collide(player, apple_4, apple_count_up);
		    game.physics.arcade.collide(player, apple_5, apple_count_up);
		    game.physics.arcade.collide(player, apple_6, apple_count_up);
		    game.physics.arcade.collide(player, apple_7, apple_count_up);
		    game.physics.arcade.collide(player, apple_8, apple_count_up);
		    game.physics.arcade.collide(player, apple_9, apple_count_up);
		    game.physics.arcade.collide(player, apple_10, apple_count_up);
        game.physics.arcade.collide(player, apple_11, apple_count_up);
		    game.physics.arcade.collide(player, apple_12, apple_count_up);
		    game.physics.arcade.collide(player, apple_13, apple_count_up);
		    game.physics.arcade.collide(player, apple_14, apple_count_up);
		    game.physics.arcade.collide(player, apple_15, apple_count_up);

		    game.physics.arcade.collide(player, albero_1);
        game.physics.arcade.collide(player, albero_2);
        game.physics.arcade.collide(player, corda);
        game.physics.arcade.collide(player, piattaforma_3);
        game.physics.arcade.collide(player, piattaforma_4);
        game.physics.arcade.collide(player, piattaforma_5);
        game.physics.arcade.collide(player, piattaforma_6);
        game.physics.arcade.collide(player, ramo_1, collision_player_ramo_1);
        game.physics.arcade.collide(player, ramo_2, collision_player_ramo_2);
        game.physics.arcade.collide(player, piattaforma_9);
        game.physics.arcade.collide(player, piattaforma_10);
        game.physics.arcade.collide(player, blocco_1);
        game.physics.arcade.collide(player, blocco_2);
		    game.physics.arcade.collide(player, blocco_3);
        game.physics.arcade.collide(player, piattaforma_f_2);

        game.physics.arcade.collide(player, muro_notte);
        game.physics.arcade.collide(player, rovo_1, collisione_rovo_1);
        game.physics.arcade.collide(player, rovo_2, collisione_rovo_2);
        game.physics.arcade.collide(player, rovo_3_1, collisione_rovo_4);
        game.physics.arcade.collide(player, rovo_3_2, collisione_rovo_4);
        game.physics.arcade.collide(player, rovo_4, collisione_rovo_4);
        game.physics.arcade.collide(player, rovo_5, collisione_rovo_4);
        game.physics.arcade.collide(player, rovo_6, collisione_rovo_4);
        game.physics.arcade.collide(player, rovo_7, collisione_rovo_4);
        game.physics.arcade.collide(player, rovo_8, collisione_rovo_4);

        game.physics.arcade.collide(player, cancello);
        game.physics.arcade.collide(player, piattaforma_notte_8);
        game.physics.arcade.collide(player, piattaforma_notte_fall_1, collisione_piattaforma_notte_fall_1);
        game.physics.arcade.collide(player, piattaforma_notte_fall_2, collisione_piattaforma_notte_fall_2);

        game.physics.arcade.collide(player, cancello_boss_room);
        game.physics.arcade.collide(player, wall_1);
        game.physics.arcade.collide(player, wall_2);
        game.physics.arcade.collide(player, wall_3);




        player.body.velocity.x = 0;
        //game.debug.bodyInfo(player, 50, 250);


        //bomb
        game.physics.arcade.collide(bomb.bullets, floor);
        game.physics.arcade.collide(bomb.bullets, blocco_1);
        game.physics.arcade.collide(bomb.bullets, blocco_2);
		    game.physics.arcade.collide(bomb.bullets, blocco_3);
        game.physics.arcade.collide(bomb.bullets, piattaforma_boss_1);
        game.physics.arcade.collide(bomb.bullets, piattaforma_boss_2);
        game.physics.arcade.collide(bomb.bullets, piattaforma_boss_3);


        //malebullet
        game.physics.arcade.overlap(malebullet_left.bullets, floor, collision_malebullet_floor);
        game.physics.arcade.overlap(malebullet_right.bullets, floor, collision_malebullet_floor);


        //femalebullet
        game.physics.arcade.overlap(femalebullet_right.bullets, corda, collision_femalebullet_corda);
        game.physics.arcade.overlap(femalebullet_right.bullets, tutorial_freccia, collision_femalebullet_tutorial_freccia);
        game.physics.arcade.overlap(femalebullet_right.bullets, target_1, collision_femalebullet_target_1);
        game.physics.arcade.overlap(femalebullet_right.bullets, target_2, collision_femalebullet_target_2);
        game.physics.arcade.overlap(femalebullet_right.bullets, target_3, collision_femalebullet_target_3);
        game.physics.arcade.overlap(femalebullet_right.bullets, piattaforma_5, collision_femalebullet_piattaforma_5);
        game.physics.arcade.overlap(femalebullet_right.bullets, leva, collision_femalebullet_leva);
        game.physics.arcade.overlap(femalebullet_left.bullets, rovo_3_2, collision_femalebullet_rovo_3_2);


        //Albero_2
        game.physics.arcade.collide(albero_2, piattaforma_1, collision_albero_2_piattaforma_1);


        //enemy_1
        game.physics.arcade.overlap(enemy_1, player, dmg_collision);
        game.physics.arcade.overlap(malebullet_right.bullets, enemy_1, collision_malebulletright_enemy_1);
        game.physics.arcade.overlap(malebullet_left.bullets, enemy_1, collision_malebulletleft_enemy_1);
        game.physics.arcade.overlap(femalebullet_right.bullets, enemy_1, collision_femalebulletright_enemy_1);
        game.physics.arcade.overlap(femalebullet_left.bullets, enemy_1, collision_femalebulletleft_enemy_1);

        //enemy_2
        game.physics.arcade.overlap(enemy_2, player, dmg_collision);
        game.physics.arcade.overlap(malebullet_right.bullets, enemy_2, collision_malebulletright_enemy_2);
        game.physics.arcade.overlap(malebullet_left.bullets, enemy_2, collision_malebulletleft_enemy_2);
        game.physics.arcade.overlap(femalebullet_right.bullets, enemy_2, collision_femalebulletright_enemy_2);
        game.physics.arcade.overlap(femalebullet_left.bullets, enemy_2, collision_femalebulletleft_enemy_2);

        //enemy_3
        game.physics.arcade.overlap(enemy_3, player, dmg_collision);
        game.physics.arcade.overlap(malebullet_right.bullets, enemy_3, collision_malebulletright_enemy_3);
        game.physics.arcade.overlap(malebullet_left.bullets, enemy_3, collision_malebulletleft_enemy_3);
        game.physics.arcade.overlap(femalebullet_right.bullets, enemy_3, collision_femalebulletright_enemy_3);
        game.physics.arcade.overlap(femalebullet_left.bullets, enemy_3, collision_femalebulletleft_enemy_3);

        //enemy_4
        game.physics.arcade.overlap(enemy_4, player, dmg_collision);
        game.physics.arcade.overlap(malebullet_right.bullets, enemy_4, collision_malebulletright_enemy_4);
        game.physics.arcade.overlap(malebullet_left.bullets, enemy_4, collision_malebulletleft_enemy_4);
        game.physics.arcade.overlap(femalebullet_right.bullets, enemy_4, collision_femalebulletright_enemy_4);
        game.physics.arcade.overlap(femalebullet_left.bullets, enemy_4, collision_femalebulletleft_enemy_4);

        //enemy_5
        game.physics.arcade.overlap(enemy_5, player, dmg_collision);
        game.physics.arcade.overlap(malebullet_right.bullets, enemy_5, collision_malebulletright_enemy_5);
        game.physics.arcade.overlap(malebullet_left.bullets, enemy_5, collision_malebulletleft_enemy_5);
        game.physics.arcade.overlap(femalebullet_right.bullets, enemy_5, collision_femalebulletright_enemy_5);
        game.physics.arcade.overlap(femalebullet_left.bullets, enemy_5, collision_femalebulletleft_enemy_5);

        //enemy_6
        game.physics.arcade.overlap(enemy_6, player, dmg_collision);
        game.physics.arcade.overlap(malebullet_right.bullets, enemy_6, collision_malebulletright_enemy_6);
        game.physics.arcade.overlap(malebullet_left.bullets, enemy_6, collision_malebulletleft_enemy_6);
        game.physics.arcade.overlap(femalebullet_right.bullets, enemy_6, collision_femalebulletright_enemy_6);
        game.physics.arcade.overlap(femalebullet_left.bullets, enemy_6, collision_femalebulletleft_enemy_6);

        //enemy_7
        game.physics.arcade.overlap(enemy_7, player, dmg_collision);
        game.physics.arcade.overlap(malebullet_right.bullets, enemy_7, collision_malebulletright_enemy_7);
        game.physics.arcade.overlap(malebullet_left.bullets, enemy_7, collision_malebulletleft_enemy_7);
        game.physics.arcade.overlap(femalebullet_right.bullets, enemy_7, collision_femalebulletright_enemy_7);
        game.physics.arcade.overlap(femalebullet_left.bullets, enemy_7, collision_femalebulletleft_enemy_7);

        //enemy_8
        game.physics.arcade.overlap(enemy_8, player, dmg_collision);
        game.physics.arcade.overlap(malebullet_right.bullets, enemy_8, collision_malebulletright_enemy_8);
        game.physics.arcade.overlap(malebullet_left.bullets, enemy_8, collision_malebulletleft_enemy_8);
        game.physics.arcade.overlap(femalebullet_right.bullets, enemy_8, collision_femalebulletright_enemy_8);
        game.physics.arcade.overlap(femalebullet_left.bullets, enemy_8, collision_femalebulletleft_enemy_8);


        //boss_fight
        game.physics.arcade.collide(player, piattaforma_boss_1);
        game.physics.arcade.collide(player, piattaforma_boss_2);
        game.physics.arcade.collide(player, piattaforma_boss_3);
        game.physics.arcade.collide(player, cancello_boss_fight_1);
        game.physics.arcade.collide(player, cancello_boss_fight_2);
        game.physics.arcade.collide(player, ingranaggio_1);
        game.physics.arcade.collide(player, ingranaggio_2);
        game.physics.arcade.collide(player, ingranaggio_3);


        game.physics.arcade.overlap(femalebullet_right.bullets, target_boss, collision_femalebullet_target_boss);
        game.physics.arcade.overlap(malebullet_right.bullets, robin, collision_malebullet_boss);
        game.physics.arcade.overlap(malebullet_right.bullets, cancello_boss_fight_1, collision_malebullet_cancello_boss_fight_1);
        game.physics.arcade.overlap(malebullet_right.bullets, cancello_boss_fight_2, collision_malebullet_cancello_boss_fight_2);
        game.physics.arcade.overlap(femalebullet_right.bullets, cancello_boss_fight_1, collision_femalebullet_cancello_boss_fight_1);
        game.physics.arcade.overlap(femalebullet_right.bullets, cancello_boss_fight_2, collision_femalebullet_cancello_boss_fight_2);

        game.physics.arcade.overlap(towerbullet_1.bullets, player, collision_towerbullet_player);
        game.physics.arcade.overlap(towerbullet_2.bullets, player, collision_towerbullet_player);
        game.physics.arcade.overlap(towerbullet_3.bullets, player, collision_towerbullet_player);

        game.physics.arcade.overlap(towerbullet_1.bullets, wall_4, collision_towerbullet_wall_4);
        game.physics.arcade.overlap(towerbullet_2.bullets, wall_4, collision_towerbullet_wall_4);
        game.physics.arcade.overlap(towerbullet_3.bullets, wall_4, collision_towerbullet_wall_4);

        game.physics.arcade.collide(robin, floor, collision_robin_floor);



























        //pauseButton
        if (pauseButton.isDown && game.paused == false) {
          menu_pausa = game.add.sprite(0, 0, 'menu_pausa');
          menu_pausa.fixedToCamera = true;
          menu_pausa.visible = true;
          game.paused = true;
          menu = true;
        }


        //parallax
        newposition = player.x
        if (oldposition == newposition || player.x < 512) {
           velocity_fore = 0;
           oldposition = newposition;
        } else if (newposition < oldposition) {
           velocity_fore = 0.5;
           foreground.x += velocity_fore;
           oldposition = newposition;
        } else if (newposition > oldposition) {
           velocity_fore = 0.5;
           foreground.x -= velocity_fore;
           oldposition = newposition;
        }


        //swap_personaggi
        if (swap_male.isDown){
           male = true;
           female = false;
        }
        if (swap_female.isDown){
           male = false;
           female = true;
        }


        //controls player 1
        newstoposition = player.x
        if (male == true) {
           if ((cursors.right.isDown && fermo == true && blocca_giocatore == false) && !fireButton.isDown) {
              player.body.velocity.x = speed;
              player.animations.play('rightG');
              oldstoposition = newstoposition;
              direction = 'right';
          } else if ((cursors.left.isDown && fermo == true && blocca_giocatore == false) && !fireButton.isDown) {
              player.body.velocity.x = -speed;
              player.animations.play('leftG');
              oldstoposition = newstoposition;
              direction = 'left';
           } else if ((newstoposition > oldstoposition && fermo == true && blocca_giocatore == false) && !fireButton.isDown) {
              player.animations.play('stoprightG');
              direction = 'right'
           } else if ((newstoposition < oldstoposition && fermo == true && blocca_giocatore == false) && !fireButton.isDown) {
              player.animations.play('stopleftG');
              direction = 'left'
           }
        } else if (female == true) {
           if ((cursors.right.isDown && fermo == true && blocca_giocatore == false) && !fireButton.isDown) {
              player.body.velocity.x = speed;
              player.animations.play('rightE');
              oldstoposition = newstoposition;
              direction = 'right';
           } else if ((cursors.left.isDown && fermo == true && blocca_giocatore == false) && !fireButton.isDown) {
              player.body.velocity.x = -speed;
              player.animations.play('leftE');
              oldstoposition = newstoposition;
              direction = 'left';
           } else if ((newstoposition > oldstoposition && fermo == true && blocca_giocatore == false) && !fireButton.isDown) {
              player.animations.play('stoprightE');
              direction = 'right'
           } else if ((newstoposition < oldstoposition && fermo == true && blocca_giocatore == false) && !fireButton.isDown) {
              player.animations.play('stopleftE');
              direction = 'left'
           }
        }


        //jump
        if (jumpButton.isDown && (player.body.onFloor() || player.body.touching.down) && blocca_giocatore == false) {
           player.body.velocity.y = -jump;
        }

        if (male == true) {
           if (cursors.left.isDown && !player.body.touching.down && blocca_giocatore == false) {
              player.animations.play('jumpleftG');
              player.body.velocity.x = -speed;
           }
           if (cursors.right.isDown && !player.body.touching.down && blocca_giocatore == false) {
              player.animations.play('jumprightG');
              player.body.velocity.x = speed;
           }
           if (!cursors.right.isDown && !cursors.left.isDown && !player.body.touching.down && blocca_giocatore == false) {
    			   if (direction ==='right') {
    				   player.animations.play('jumprightG');
    			   } else {
               player.animations.play('jumpleftG');
    		     }
           }

        } else if (female == true) {
           if (cursors.left.isDown && !player.body.touching.down && blocca_giocatore == false) {
              player.animations.play('jumpleftE');
              player.body.velocity.x = -speed;
           }
           if (cursors.right.isDown && !player.body.touching.down && blocca_giocatore == false) {
              player.animations.play('jumprightE');
              player.body.velocity.x = speed;
           }
           if (!cursors.right.isDown && !cursors.left.isDown && !player.body.touching.down && blocca_giocatore == false) {
    			   if (direction ==='right') {
    				   player.animations.play('jumprightE');
    			   } else {
               player.animations.play('jumpleftE');
    		     }
           }
        }


        //fly_area
        if ( female == true && (
           (player.x > 4200 && player.x < 4475) || (player.x > 9375 && player.x < 9625) ||
           (player.x > 9995 && player.x < 10245) || (player.x > l_bosco + 998 && player.x < 16377) ||
           (player.x > l_bosco + 2425 && player.x < l_bosco + 2635) || (player.x > l_bosco + 2740 && player.x < l_bosco + 2950) ||
           (player.x > l_bosco + 3040 && player.x < l_bosco + 3250) || (player.x > l_bosco+l_bosco_notte + 4120 && player.x < l_bosco+l_bosco_notte +4260 && corrente_castello == true)) ) {
          //cape
          if (abilityButton.isDown && !player.body.touching.down && direction === 'right') {
            player.animations.play('caperightE');
            player.body.velocity.y = -air_velocity;
          } else if (abilityButton.isDown && !player.body.touching.down && direction === 'left') {
            player.animations.play('capeleftE');
            player.body.velocity.y = -air_velocity;
          }
        }


        //bomb_creation
        if (abilityButton.isDown && (player.body.onFloor() || player.body.touching.down) && dropbomb == true && male == true) {
            bomb.fire();
            dropbomb = false;
            bomb_is_placed = true;
            game.time.events.add(3000, function () {
              game.time.events.add(100, function () {
                game.camera.flash(0xffff00, 500);
                explosion.animations.add('explosionstart', [0,1,2,3,4,5,0,1,2,3,4,5,6], 15, false);
                explosion.animations.play('explosionstart');
                bomb_is_placed = false;
              });
              explosion = game.add.sprite(bomb.x-45, bomb.y-20, 'explosion');
              dropbomb = true;
              if ( ((player.x - explosion.x) > -75) && ((player.x - explosion.x) < 75) ) {
                if (inside_boss_room == false) {
                  player.x -= 100;
                }
                player_hp -= 1;
                player.tint = 0xff0000;
                game.time.events.add(200, function () {
                  player.tint = 0xffffff;
                });
              }
              if (explosion.x > 6095 && explosion.x < 6253) {
                blocco_1.kill();
              } else if (explosion.x > 13575 && explosion.x < 13775) {
                blocco_2.kill();
              } else if (explosion.x > l_bosco+l_bosco_notte+4115 && explosion.x < l_bosco+l_bosco_notte+4280) {
                blocco_3.kill();
				        corrente_11.body.velocity.y=-100
				        if (corrente_11.y > 0) {
				          corrente_11.body.velocity.y = 0;
					        corrente_11.y = 0;
					        corrente_castello = true
                }
              }
              if (explosion.x > 26135 && explosion.x < 26250) {
                boss_hp -= 1;
                boss_is_down = true;
                robin.animations.play('robin_confuso');
                robin.tint = 0xff0000;
                game.time.events.add(200, function () {
                  robin.tint = 0xffffff;
                });
                ingranaggio_1.body.angularVelocity = 0;
                ingranaggio_1.tint = 0xff0000;
                game.time.events.add(1000, function () {
                  ingranaggio_1.tint = 0xffffff;
                  ingranaggio_1.body.angularVelocity = -65;
                });
                ingranaggio_2.body.angularVelocity = 0;
                ingranaggio_2.tint = 0xff0000;
                game.time.events.add(1000, function () {
                  ingranaggio_2.tint = 0xffffff;
                  ingranaggio_2.body.angularVelocity = 75;
                });
                ingranaggio_3.body.angularVelocity = 0;
                ingranaggio_3.tint = 0xff0000;
                game.time.events.add(1000, function () {
                  ingranaggio_3.tint = 0xffffff;
                  ingranaggio_3.body.angularVelocity = 50;
                });


                if (boss_hp == 5) {
                  game.time.events.remove(arrowloop_1);
                } else if (boss_hp == 4) {
                  game.time.events.remove(arrowloop_2);
                  game.time.events.remove(arrowloop_3);
                  game.time.events.remove(arrowloop_4);
                } else if (boss_hp == 3) {
                  game.time.events.remove(arrowloop_5);
                  game.time.events.remove(arrowloop_6);
                  game.time.events.remove(arrowloop_7);
                } else if (boss_hp == 2) {
                  game.time.events.remove(arrowloop_8);
                  game.time.events.remove(arrowloop_9);
                } else if (boss_hp == 1) {
                  game.time.events.remove(arrowloop_10);
                  game.time.events.remove(arrowloop_11);
                } else if (boss_hp == 0) {
                  game.time.events.remove(arrowloop_12);
                  game.time.events.remove(arrowloop_13);
                  game.time.events.remove(arrowloop_14);
                  game.time.events.remove(arrowloop_15);
                  game.time.events.remove(arrowloop_16);
                }
              }
            });
        }


        //bulletfire
        if (tempo == true && ((fireButton.isDown && newstoposition > oldstoposition) || (fireButton.isDown && cursors.right.isDown))) {
           tempo = false;
           if (male == true && (player.body.onFloor() || player.body.touching.down)) {
              fermo = false;
              player.animations.play('firerightG');
              malebullet_right.fire();
              player.animations.isFinished = true;
           } else if (female == true && (player.body.onFloor() || player.body.touching.down)) {
              fermo = false;
              player.animations.play('firerightE');
              femalebullet_right.fire();
              player.animations.isFinished = true;
           }
           if (player.animations.isFinished == true) {
              game.time.events.add(242, function () {
                 player.animations.stop();
                 fermo = true;
              });
           }
           game.time.events.add(2000, function () {
             tempo = true;
           });

        } else if (tempo == true && ((fireButton.isDown && newstoposition < oldstoposition) || (fireButton.isDown && cursors.left.isDown))) {
           tempo = false;
           if (male == true && (player.body.onFloor() || player.body.touching.down)) {
              fermo = false;
              player.animations.play('fireleftG');
              malebullet_left.fire();
              player.animations.isFinished = true;
            } else if (female == true && (player.body.onFloor() || player.body.touching.down)) {
              fermo = false;
              player.animations.play('fireleftE');
              femalebullet_left.fire();
              player.animations.isFinished = true;
            }
            if (player.animations.isFinished == true) {
              game.time.events.add(242, function () {
                player.animations.stop();
                fermo = true;
              });
            }
            game.time.events.add(2000, function () {
              tempo = true;
            });
        }


        //bullets_collision
        function collision_malebullet_floor(a, b) {
          a.kill();
        }

        function collision_femalebullet_piattaforma_5(a, b) {
          b.kill();
        }

        function collision_femalebullet_corda(a, b) {
          a.kill();
          b.kill();
          albero_2.body.gravity.y = gravity;
          albero_2.body.immovable = false;
          piattaforma_1.body.immovable = false;
        }

        function collision_femalebullet_tutorial_freccia(a, b) {
          a.kill();
        }

        function collision_femalebullet_target_1(a, b) {
          a.kill();
          b.kill();
          albero_1.body.angularVelocity = 50;
          albero_1.body.enable = true;
          game.time.events.add(1610, function () {
             albero_1.body.angularVelocity = 0;
          });
          albero_1.body.setSize(506, 50, 50, 470);
        }

        function collision_femalebullet_target_2(a, b) {
          a.kill();
          b.kill();
          piattaforma_3.body.angularVelocity = 75;
          piattaforma_3.body.enable = true;
          game.time.events.add(1215, function () {
             piattaforma_3.body.angularVelocity = 0;
          });
          piattaforma_3.body.setSize(270, 40, -110, 125);
        }

        function collision_femalebullet_target_3(a, b) {
          a.kill();
          b.kill();
          piattaforma_5.body.angularVelocity = 75;
          game.time.events.add(1215, function () {
             piattaforma_5.body.angularVelocity = 0;
          });
          piattaforma_5.body.setSize(270, 40, -110, 125);
        }

        function collision_femalebullet_rovo_3_2(a, b) {
          b.kill();
        }

        function collision_femalebullet_leva(a, b) {
          a.kill();
          b.kill();
          leva_attivata.visible = true;
          cancello.kill();
        }














        //albero_2_collision
        function collision_albero_2_piattaforma_1(a, b) {
          albero_2.body.gravity.y = 0;
          albero_2.body.velocity.y = 0;
          albero_2.body.immovable = true;
          albero_2.body.setSize(700, 50, 0, 15);
          piattaforma_1.body.velocity.y = 0;
          piattaforma_1.body.immovable = true;
        }

        //movimento_piattaforma_4 e target_3
        if (piattaforma_4.y < 170) {
          piattaforma_4.body.velocity.y = platform_velocity;
        } else if (piattaforma_4.y > 430) {
          piattaforma_4.body.velocity.y = -platform_velocity;
        }

        if (target_3.x < 10850) {
          target_3.body.velocity.x = target_velocity;
        } else if (target_3.x > 11050) {
          target_3.body.velocity.x = -target_velocity;
        }


        //rami_che_cadono
        function collision_player_ramo_1(a, b) {
          game.time.events.add(100, function () {
            game.camera.shake(0.001, 500);
            ramo_1.body.immovable = false;
            //ramo_1.body.velocity.y = 75;
            ramo_1.body.velocity.x = 0;
          });
        }

        function collision_player_ramo_2(a, b) {
          game.time.events.add(100, function () {
            game.camera.shake(0.001, 500);
            ramo_2.body.immovable = false;
            //ramo_2.body.velocity.y = 75;
            ramo_2.body.velocity.x = 0;
          });
        }


        //stanza_segreta_function
        if (player.x > 5737 && player.x < 6112 && player.y > 484) {
          copertura_piattaforma_f.visible = false;
          piattaforma_f_2.body.enable = false;
          piattaforma_f_2.visible = false;
        }


        //collisioni_rovi
        function collisione_rovo_1(a, b) {
          player_hp -= 1;
          player.x = 15602;
          player.y = 375;
          player.tint = 0xff0000;
          game.time.events.add(200, function () {
            player.tint = 0xffffff;
          });
        }

        function collisione_rovo_2(a, b) {
          player_hp -= 1;
          player.x = 17050;
          player.y = 350;
          player.tint = 0xff0000;
          game.time.events.add(200, function () {
            player.tint = 0xffffff;
          });
        }

        function collisione_rovo_4(a, b) {
          player_hp -= 1;
          player.x = 17418;
          player.y = 600;
          player.tint = 0xff0000;
          game.time.events.add(200, function () {
            player.tint = 0xffffff;
          });
        }


        //piattaforma_notte_fall_1
        function collisione_piattaforma_notte_fall_1(a, b) {
          /*game.time.events.add(100, function () {
            game.camera.shake(0.001, 500);
            piattaforma_notte_fall_1.body.immovable = false;
            piattaforma_notte_fall_1.body.velocity.x = 0;
          });
          game.time.events.add(250, function () {
            piattaforma_notte_fall_1.body.velocity.y = 150;
          });
          game.time.events.add(5000, function () {
            piattaforma_notte_fall_1.kill();
            piattaforma_notte_fall_1 = game.add.sprite(l_bosco + 1875, 430, 'piattaforma_notte_8');
            game.physics.arcade.enable(piattaforma_notte_fall_1);
            piattaforma_notte_fall_1.body.immovable = true;
          });*/
        }


        //piattaforma_notte_fall_2
        function collisione_piattaforma_notte_fall_2(a, b) {
          game.time.events.add(100, function () {
            game.camera.shake(0.001, 500);
            piattaforma_notte_fall_2.body.immovable = false;
            piattaforma_notte_fall_2.body.velocity.x = 0;
          });
          game.time.events.add(250, function () {
            piattaforma_notte_fall_2.body.velocity.y = 150;
          });
          game.time.events.add(5000, function () {
            piattaforma_notte_fall_2.kill();
            piattaforma_notte_fall_2 = game.add.sprite(l_bosco + 2050, 370, 'piattaforma_notte_cade');
            game.physics.arcade.enable(piattaforma_notte_fall_2);
            piattaforma_notte_fall_2.body.immovable = true;
          });
        }













        //hud_hp
        if (player_hp == 3 && male == true){
          hp_3_G.visible = true;
          hp_2_G.visible = false;
          hp_1_G.visible = false;

          hp_3_E.visible = false;
          hp_2_E.visible = false;
          hp_1_E.visible = false;

       } else if (player_hp == 2 && male == true){
          hp_3_G.visible = false;
          hp_2_G.visible = true;
          hp_1_G.visible = false;

          hp_3_E.visible = false;
          hp_2_E.visible = false;
          hp_1_E.visible = false;

       } else if (player_hp == 1 && male == true){
          hp_3_G.visible = false;
          hp_2_G.visible = false;
          hp_1_G.visible = true;

          hp_3_E.visible = false;
          hp_2_E.visible = false;
          hp_1_E.visible = false;

       } else if (player_hp == 3 && female == true){
          hp_3_E.visible = true;
          hp_2_E.visible = false;
          hp_1_E.visible = false;

          hp_3_G.visible = false;
          hp_2_G.visible = false;
          hp_1_G.visible = false;

       } else if (player_hp == 2 && female == true){
          hp_3_E.visible = false;
          hp_2_E.visible = true;
          hp_1_E.visible = false;

          hp_3_G.visible = false;
          hp_2_G.visible = false;
          hp_1_G.visible = false;

       } else if (player_hp == 1 && female == true){
          hp_3_E.visible = false;
          hp_2_E.visible = false;
          hp_1_E.visible = true;

          hp_3_G.visible = false;
          hp_2_G.visible = false;
          hp_1_G.visible = false;
        }


        //hud_apple_count
        function apple_count_up(a, b) {
          b.kill();
          apple_counter += 1;
          if (apple_counter == 1){
            n_00.visible = false;
            n_01.visible = true;
            n_01.tint = 0x00ff00;
            game.time.events.add(400, function () {
              n_01.tint = 0xffffff;
            });
          } else if (apple_counter == 2){
            n_01.visible = false;
            n_02.visible = true;
            n_02.tint = 0x00ff00;
            game.time.events.add(400, function () {
              n_02.tint = 0xffffff;
            });
          } else if (apple_counter == 3){
            n_02.visible = false;
            n_03.visible = true;
            n_03.tint = 0x00ff00;
            game.time.events.add(400, function () {
              n_03.tint = 0xffffff;
            });
          } else if (apple_counter == 4){
            n_03.visible = false;
            n_04.visible = true;
            n_04.tint = 0x00ff00;
            game.time.events.add(400, function () {
              n_04.tint = 0xffffff;
            });
          } else if (apple_counter == 5){
            n_04.visible = false;
            n_05.visible = true;
            n_05.tint = 0x00ff00;
            game.time.events.add(400, function () {
              n_05.tint = 0xffffff;
            });
          } else if (apple_counter == 6){
            n_05.visible = false;
            n_06.visible = true;
            n_06.tint = 0x00ff00;
            game.time.events.add(400, function () {
              n_06.tint = 0xffffff;
            });
          } else if (apple_counter == 7){
            n_06.visible = false;
            n_07.visible = true;
            n_07.tint = 0x00ff00;
            game.time.events.add(400, function () {
              n_07.tint = 0xffffff;
            });
          } else if (apple_counter == 8){
            n_07.visible = false;
            n_08.visible = true;
            n_08.tint = 0x00ff00;
            game.time.events.add(400, function () {
              n_08.tint = 0xffffff;
            });
          } else if (apple_counter == 9){
            n_08.visible = false;
            n_09.visible = true;
            n_09.tint = 0x00ff00;
            game.time.events.add(400, function () {
              n_09.tint = 0xffffff;
            });
          } else if (apple_counter == 10){
            n_09.visible = false;
            n_10.visible = true;
            n_10.tint = 0x00ff00;
            game.time.events.add(400, function () {
              n_10.tint = 0xffffff;
            });
          } else if (apple_counter == 11){
            n_10.visible = false;
            n_11.visible = true;
            n_11.tint = 0x00ff00;
            game.time.events.add(400, function () {
              n_11.tint = 0xffffff;
            });
          } else if (apple_counter == 12){
            n_11.visible = false;
            n_12.visible = true;
            n_12.tint = 0x00ff00;
            game.time.events.add(400, function () {
              n_12.tint = 0xffffff;
            });
          } else if (apple_counter == 13){
            n_12.visible = false;
            n_13.visible = true;
            n_13.tint = 0x00ff00;
            game.time.events.add(400, function () {
              n_13.tint = 0xffffff;
            });
          } else if (apple_counter == 14){
            n_13.visible = false;
            n_14.visible = true;
            n_14.tint = 0x00ff00;
            game.time.events.add(400, function () {
              n_14.tint = 0xffffff;
            });
            mele_raccolte = true;
          } else if (apple_counter == 15){
            n_14.visible = false;
            n_15.visible = true;
            n_15.tint = 0x00ff00;
            game.time.events.add(400, function () {
              n_15.tint = 0xffffff;
            });
          }
        }









        //show_message_txt
        if (player.x > 150 && istruzioni_visibili == true) {
          istruzioni_visibili = false;
              istruzioni.visible = false;
        }

        if (player.x < 100 && istruzioni_visibili == false) {
          istruzioni_visibili = true;
              istruzioni.visible = true;
        }

        if (player.x > 770 && player.x < 920) {
            tutorial_1.visible = true;
            game.time.events.add(100, function () {
              tutorial_1.visible = false;
            });
        }

        if (player.x > 1175 && player.x < 1325) {
            tutorial_2.visible = true;
            game.time.events.add(100, function () {
              tutorial_2.visible = false;
            });
        }

        if (player.x > 2345 && player.x < 2500) {
            tutorial_3.visible = true;
            game.time.events.add(100, function () {
              tutorial_3.visible = false;
            });
        }

        if (player.x > 3900 && player.x < 4050) {
            tutorial_4.visible = true;
            game.time.events.add(100, function () {
              tutorial_4.visible = false;
            });
        }

        if (player.x > 4650 && player.x < 4800) {
            tutorial_5.visible = true;
            game.time.events.add(100, function () {
              tutorial_5.visible = false;
            });
        }

        if (player.x > 6000 && player.x < 6150) {
            tutorial_6.visible = true;
            game.time.events.add(100, function () {
              tutorial_6.visible = false;
            });
        }

        if ((player.x > 365 && player.x < 465) && checkpoint_1_status == false) {
            tutorial_7.visible = true;
            game.time.events.add(100, function () {
              tutorial_7.visible = false;
            });
        }

        if ((player.x > 6800 && player.x < 6975) && checkpoint_2_status == false) {
            tutorial_8.visible = true;
            game.time.events.add(100, function () {
              tutorial_8.visible = false;
            });
        }

        if ((player.x > 14100 && player.x < 14275) && checkpoint_3_status == false) {
            tutorial_9.visible = true;
            game.time.events.add(100, function () {
              tutorial_9.visible = false;
            });
        }

        if ((player.x > 19000 && player.x < 19175) && checkpoint_4_status == false) {
            tutorial_10.visible = true;
            game.time.events.add(100, function () {
              tutorial_10.visible = false;
            });
        }

        /*if ((player.x > 24850 && player.x < 25025) && checkpoint_5_status == false) {
            tutorial_11.visible = true;
            game.time.events.add(100, function () {
              tutorial_11.visible = false;
            });
        }*/


        //checkpoints_animations
        /*if (player.x > 400 && player.x < 575) {
          if (bonfireButton.isDown && checkpoint_1_status == false) {
            checkpoint_1_status = true;
            checkpoint_1.animations.play('bonfire_lighting_up');
            game.time.events.add (1000, function () {
              checkpoint_1.animations.stop();
              checkpoint_1.animations.play('bonfire_up');
            });
          }
        }*/

        if (player.x > 6800 && player.x < 6975) {
          if (bonfireButton.isDown && checkpoint_2_status == false) {
            checkpoint_2_status = true;
            checkpoint_2.animations.play('bonfire_lighting_up');
            game.time.events.add(1000, function () {
              checkpoint_2.animations.stop();
              checkpoint_2.animations.play('bonfire_up');
            });
          }
        }

        if (player.x > 14100 && player.x < 14275) {
          if (bonfireButton.isDown && checkpoint_3_status == false) {
            checkpoint_3_status = true;
            checkpoint_3.animations.play('bonfire_lighting_up');
            game.time.events.add (1000, function () {
              checkpoint_3.animations.stop();
              checkpoint_3.animations.play('bonfire_up');
            });
          }
        }

        if (player.x > 19000 && player.x < 19175) {
          if (bonfireButton.isDown && checkpoint_4_status == false) {
            checkpoint_4_status = true;
            checkpoint_4.animations.play('bonfire_lighting_up');
            game.time.events.add (1000, function () {
              checkpoint_4.animations.stop();
              checkpoint_4.animations.play('bonfire_up');
            });
          }
        }

        if (player.x > 24850 && player.x < 25025) {
          if (checkpoint_5_status == false) {
            checkpoint_5_status = true;
            /*checkpoint_5.animations.play('bonfire_lighting_up');
            game.time.events.add (1000, function () {
              checkpoint_5.animations.stop();
              checkpoint_5.animations.play('bonfire_up');
            });*/
          }
        }


        //last_checkpoint
        if ((player.x > checkpoint_1.x) && (player.x < checkpoint_2.x) && checkpoint_2_status == false) {
          last_checkpoint_x = checkpoint_1.x;
          last_checkpoint_y = checkpoint_1.y;
        } else if ((player.x > checkpoint_1.x) && (player.x < checkpoint_3.x) && checkpoint_2_status == true && checkpoint_3_status == false) {
          last_checkpoint_x = checkpoint_2.x;
          last_checkpoint_y = checkpoint_2.y;
        } else if ((player.x > checkpoint_2.x) && (player.x < checkpoint_4.x) && checkpoint_3_status == true && checkpoint_4_status == false) {
          last_checkpoint_x = checkpoint_3.x;
          last_checkpoint_y = checkpoint_3.y;
        } else if ((player.x > checkpoint_3.x) && (player.x < checkpoint_5.x) && checkpoint_4_status == true && checkpoint_5_status == false) {
          last_checkpoint_x = checkpoint_4.x;
          last_checkpoint_y = checkpoint_4.y;
        } else if ((player.x > checkpoint_5.x) && checkpoint_5_status == true) {
          last_checkpoint_x = checkpoint_5.x;
          last_checkpoint_y = checkpoint_5.y;
        }


        //reset_player
        if (player_hp == 0 && checkpoint_5_status == false) {
          player.x = last_checkpoint_x + 250;
          player.y = last_checkpoint_y + 125;
          player_hp = 3
          foreground.x = 0;

          if ((player.x > checkpoint_1.x) && (player.x < checkpoint_3.x)) {
            albero_1.kill();
            target_1.kill();
            corda.kill();
            albero_2.kill();
            tutorial_freccia.kill();

            albero_1 = game.add.sprite(1560, 735,'albero_1');
            albero_1.anchor.x = 0.3;
            albero_1.anchor.y = 1;
            game.physics.arcade.enable(albero_1);
            albero_1.body.immovable = true;
            albero_1.body.enable = false;

            target_1 = game.add.sprite(1511, 630,'bersaglio');
            game.physics.arcade.enable(target_1);

            corda = game.add.sprite(5320, 0,'corda');
            game.physics.arcade.enable(corda);

            albero_2 = game.add.sprite(5053, 207,'albero_2');
            game.physics.arcade.enable(albero_2);
            albero_2.body.immovable = true;
            albero_2.body.enable = true;
            albero_2.body.setSize(700, 75, 0, 15);

            tutorial_freccia = game.add.sprite(5090, 110,'tutorial_freccia');
            game.physics.arcade.enable(tutorial_freccia);
          }

          if ((player.x > checkpoint_2.x) && (player.x < checkpoint_4.x)) {
            piattaforma_3.kill();
            piattaforma_5.kill();
            target_2.kill();
            target_3.kill();
            blocco_2.kill();

            piattaforma_3 = game.add.sprite(8835, 465,'piattaforma_3');
            game.physics.arcade.enable(piattaforma_3);
            piattaforma_3.body.immovable = true;
            piattaforma_3.body.enable = false;
            piattaforma_3.anchor.x = 0.5;
            piattaforma_3.anchor.y = 0.5;

            piattaforma_5 = game.add.sprite(11000, 250,'piattaforma_5');
            game.physics.arcade.enable(piattaforma_5);
            piattaforma_5.body.immovable = true;
            piattaforma_5.anchor.x = 0.5;
            piattaforma_5.anchor.y = 0.5;

            target_2 = game.add.sprite(8797, 463,'bersaglio');
            game.physics.arcade.enable(target_2);

            target_3 = game.add.sprite(10950, 204,'bersaglio');
            game.physics.arcade.enable(target_3);
            target_3.body.velocity.x = -target_velocity;

            blocco_2 = game.add.sprite(13677.857, 590.974, 'blocco_2');
            game.physics.arcade.enable(blocco_2);
            blocco_2.body.immovable = true;

            ramo_1.kill();
              ramo_1 = game.add.sprite(11300, 342,'piattaforma_7_2');
              game.physics.arcade.enable(ramo_1);
              ramo_1.body.immovable = true;

            ramo_2.kill();
              ramo_2 = game.add.sprite(11690, 306,'piattaforma_8');
              game.physics.arcade.enable(ramo_2);
              ramo_2.body.immovable = true;
          }

        };


        //dmg_collision
        function dmg_collision(a, b) {
          player_hp -= 1;
          player.x -= 200;
          //player.y -= 100;
          player.tint = 0xff0000;
          game.time.events.add(200, function () {
            player.tint = 0xffffff;
          });
        }


        //player_y_dmg
        if ((player.y > 800) && (player.x > 800) && (player.x < 1100)) {
          player_hp -= 1;
          player.x = 700;
          player.y = 600;
          player.tint = 0xff0000;
          game.time.events.add(200, function () {
            player.tint = 0xffffff;
          });
        }


        if ((player.y > 800) && (player.x > 1500) && (player.x < 2150)) {
          player_hp -= 1;
          player.x = 1385;
          player.y = 600;
          player.tint = 0xff0000;
          game.time.events.add(200, function () {
            player.tint = 0xffffff;
          });
        }


        if ((player.y > 800) && (player.x > 3200) && (player.x < 3600)) {
          player_hp -= 1;
          player.x = 2586;
          player.y = 500;
          player.tint = 0xff0000;
          game.time.events.add(200, function () {
            player.tint = 0xffffff;
          });
        }


        if ( ((player.y > 800) || (player.y < -300)) && (player.x > 4100) && (player.x < 4600) ) {
          player_hp -= 1;
          player.x = 3926;
          player.y = 500;
          player.tint = 0xff0000;
          game.time.events.add(200, function () {
            player.tint = 0xffffff;
          });
        }


        if ((player.y > 800) && (player.x > 7800) && (player.x < 8200)) {
          player_hp -= 1;
          player.x = 7854;
          player.y = 400;
          player.tint = 0xff0000;
          game.time.events.add(200, function () {
            player.tint = 0xffffff;
          });
        }


        if ( ((player.y > 800) || (player.y < -400)) && (player.x > 8400) && (player.x < 9099) ) {
          player_hp -= 1;
          player.x = 8450;
          player.y = 400;
          player.tint = 0xff0000;
          game.time.events.add(200, function () {
            player.tint = 0xffffff;
          });
        }


        if ( ((player.y > 800) || (player.y < -400)) && ((player.x > 9201) && (player.x < 12100)) ) {
          ramo_1.kill();
          ramo_2.kill();

          player_hp = player_hp - 1;
          player.x = 9200;
          player.y = 400;

          player.tint = 0xff0000;
          game.time.events.add (200, function () {
            player.tint = 0xffffff;
          });

            ramo_1 = game.add.sprite(11300, 342,'piattaforma_7_2');
            game.physics.arcade.enable(ramo_1);
            ramo_1.body.immovable = true;

            ramo_2 = game.add.sprite(11690, 306,'piattaforma_8');
            game.physics.arcade.enable(ramo_2);
            ramo_2.body.immovable = true;
        }


        if ( ((player.y > 800) || (player.y < -400)) && ((player.x > 16000) && (player.x < 16600)) ) {
          player_hp -= 1;
          player.x = 15602;
          player.y = 375;

          player.tint = 0xff0000;
          game.time.events.add (200, function () {
            player.tint = 0xffffff;
          });
        }


        if ( ((player.y > 800) || (player.y < -400)) && ((player.x > 17400) && (player.x < 18800)) ) {
          player_hp -= 1;
          player.x = 17418;
          player.y = 600;

          player.tint = 0xff0000;
          game.time.events.add (200, function () {
            player.tint = 0xffffff;
          });
        }

		    if ( ((player.y > 800) || (player.y < -400)) && ((player.x > l_bosco+l_bosco_notte + 4100) && (player.x < l_bosco+l_bosco_notte + 4300)) ) {
          player_hp -= 1;
          player.x = l_bosco+l_bosco_notte+4050;
          player.y = 600;

          player.tint = 0xff0000;
          game.time.events.add (200, function () {
            player.tint = 0xffffff;
          });
        }














        //enemy_1
        function collision_malebulletright_enemy_1(a, b) {
          b.kill();
          enemy_1.body.velocity.x = 0;
          enemy_1_down = true;
          enemy_1.body.setSize(1, 1, 0, -1000)
          enemy_1.animations.stop();
          enemy_1.animations.play('starleft');
          game.time.events.add(3500, function () {
            if (enemy_1_newposition > enemy_1_oldposition) {
              enemy_1.body.velocity.x = enemy_speed;
            } else if (enemy_1_newposition < enemy_1_oldposition) {
              enemy_1.body.velocity.x = -enemy_speed;
            }
            enemy_1_down = false;
            enemy_1.body.setSize(78, 105, 0, 0)
          });
        }
        function collision_femalebulletright_enemy_1(a, b) {
          b.kill();
          enemy_1.body.velocity.x = 0;
          enemy_1.animations.stop();
          enemy_1.animations.play('arrowleft');
          enemy_1_down = true;
          game.time.events.add(1000, function () {
            if (enemy_1_newposition > enemy_1_oldposition) {
              enemy_1.body.velocity.x = enemy_speed;
            } else if (enemy_1_newposition < enemy_1_oldposition) {
              enemy_1.body.velocity.x = -enemy_speed;
            }
            enemy_1_down = false;
          });
        }
        function collision_malebulletleft_enemy_1(a, b) {
          b.kill();
          enemy_1.body.velocity.x = 0;
          enemy_1_down = true;
          enemy_1.body.setSize(1, 1, 0, -1000)
          enemy_1.animations.stop();
          enemy_1.animations.play('starright');
          game.time.events.add(3500, function () {
            if (enemy_1_newposition > enemy_1_oldposition) {
              enemy_1.body.velocity.x = enemy_speed;
            } else if (enemy_1_newposition < enemy_1_oldposition) {
              enemy_1.body.velocity.x = -enemy_speed;
            }
            enemy_1_down = false;
            enemy_1.body.setSize(78, 105, 0, 0)
          });
        }
        function collision_femalebulletleft_enemy_1(a, b) {
          b.kill();
          enemy_1.body.velocity.x = 0;
          enemy_1.animations.stop();
          enemy_1.animations.play('arrowright');
          enemy_1_down = true;
          game.time.events.add(1000, function () {
            if (enemy_1_newposition > enemy_1_oldposition) {
              enemy_1.body.velocity.x = enemy_speed;
            } else if (enemy_1_newposition < enemy_1_oldposition) {
              enemy_1.body.velocity.x = -enemy_speed;
            }
            enemy_1_down = false;
          });
        }
        //movements
        enemy_1_newposition = enemy_1.x;
        if ((enemy_1_down == false) && (enemy_1_newposition > enemy_1_oldposition)) {
          enemy_1.animations.play('enemyright');
          enemy_1_oldposition = enemy_1_newposition;
        } else if ((enemy_1_down == false) && (enemy_1_newposition < enemy_1_oldposition)) {
          enemy_1.animations.play('enemyleft');
          enemy_1_oldposition = enemy_1_newposition;
        }
        if (enemy_1.x > 3200) {
          enemy_1.body.velocity.x = -enemy_speed;
        } else if (enemy_1.x < 2900) {
          enemy_1.body.velocity.x = enemy_speed;
        }


        //enemy_2
        function collision_malebulletright_enemy_2(a, b) {
          b.kill();
          enemy_2.body.velocity.x = 0;
          enemy_2_down = true;
          enemy_2.body.setSize(1, 1, 0, -1000)
          enemy_2.animations.stop();
          enemy_2.animations.play('starleft');
          game.time.events.add(3500, function () {
            if (enemy_2_newposition > enemy_2_oldposition) {
              enemy_2.body.velocity.x = enemy_speed;
            } else if (enemy_2_newposition < enemy_2_oldposition) {
              enemy_2.body.velocity.x = -enemy_speed;
            }
            enemy_2_down = false;
            enemy_2.body.setSize(78, 105, 0, 0)
          });
        }
        function collision_femalebulletright_enemy_2(a, b) {
          b.kill();
          enemy_2.body.velocity.x = 0;
          enemy_2.animations.stop();
          enemy_2.animations.play('arrowleft');
          enemy_2_down = true;
          game.time.events.add(3500, function () {
            if (enemy_2_newposition > enemy_2_oldposition) {
              enemy_2.body.velocity.x = enemy_speed;
            } else if (enemy_2_newposition < enemy_2_oldposition) {
              enemy_2.body.velocity.x = -enemy_speed;
            }
            enemy_2_down = false;
          });
        }
        function collision_malebulletleft_enemy_2(a, b) {
          b.kill();
          enemy_2.body.velocity.x = 0;
          enemy_2_down = true;
          enemy_2.body.setSize(1, 1, 0, -1000)
          enemy_2.animations.stop();
          enemy_2.animations.play('starright');
          game.time.events.add(3500, function () {
            if (enemy_2_newposition > enemy_2_oldposition) {
              enemy_2.body.velocity.x = enemy_speed;
            } else if (enemy_2_newposition < enemy_2_oldposition) {
              enemy_2.body.velocity.x = -enemy_speed;
            }
            enemy_2_down = false;
            enemy_2.body.setSize(78, 105, 0, 0)
          });
        }
        function collision_femalebulletleft_enemy_2(a, b) {
          b.kill();
          enemy_2.body.velocity.x = 0;
          enemy_2.animations.stop();
          enemy_2.animations.play('arrowright');
          enemy_2_down = true;
          game.time.events.add(1000, function () {
            if (enemy_2_newposition > enemy_2_oldposition) {
              enemy_2.body.velocity.x = enemy_speed;
            } else if (enemy_2_newposition < enemy_2_oldposition) {
              enemy_2.body.velocity.x = -enemy_speed;
            }
            enemy_2_down = false;
          });
        }
        //movements
        enemy_2_newposition = enemy_2.x;
        if ((enemy_2_down == false) && (enemy_2_newposition > enemy_2_oldposition)) {
          enemy_2.animations.play('enemyright');
          enemy_2_oldposition = enemy_2_newposition;
        } else if ((enemy_2_down == false) && (enemy_2_newposition < enemy_2_oldposition)) {
          enemy_2.animations.play('enemyleft');
          enemy_2_oldposition = enemy_2_newposition;
        }
        if (enemy_2.x > 5750) {
          enemy_2.body.velocity.x = -enemy_speed;
        } else if (enemy_2.x < 5550) {
          enemy_2.body.velocity.x = enemy_speed;
        }


        //enemy_3
        function collision_malebulletright_enemy_3(a, b) {
          b.kill();
          enemy_3.body.velocity.x = 0;
          enemy_3_down = true;
          enemy_3.body.setSize(1, 1, 0, -1000)
          enemy_3.animations.stop();
          enemy_3.animations.play('starleft');
          game.time.events.add(3500, function () {
            if (enemy_3_newposition > enemy_3_oldposition) {
              enemy_3.body.velocity.x = enemy_speed;
            } else if (enemy_3_newposition < enemy_3_oldposition) {
              enemy_3.body.velocity.x = -enemy_speed;
            }
            enemy_3_down = false;
            enemy_3.body.setSize(78, 105, 0, 0)
          });
        }
        function collision_femalebulletright_enemy_3(a, b) {
          b.kill();
          enemy_3.body.velocity.x = 0;
          enemy_3.animations.stop();
          enemy_3.animations.play('arrowleft');
          enemy_3_down = true;
          game.time.events.add(1000, function () {
            if (enemy_3_newposition > enemy_3_oldposition) {
              enemy_3.body.velocity.x = enemy_speed;
            } else if (enemy_3_newposition < enemy_3_oldposition) {
              enemy_3.body.velocity.x = -enemy_speed;
            }
            enemy_3_down = false;
          });
        }
        function collision_malebulletleft_enemy_3(a, b) {
          b.kill();
          enemy_3.body.velocity.x = 0;
          enemy_3_down = true;
          enemy_3.body.setSize(1, 1, 0, -1000)
          enemy_3.animations.stop();
          enemy_3.animations.play('starright');
          game.time.events.add(3500, function () {
            if (enemy_3_newposition > enemy_3_oldposition) {
              enemy_3.body.velocity.x = enemy_speed;
            } else if (enemy_3_newposition < enemy_3_oldposition) {
              enemy_3.body.velocity.x = -enemy_speed;
            }
            enemy_3_down = false;
            enemy_3.body.setSize(78, 105, 0, 0)
          });
        }
        function collision_femalebulletleft_enemy_3(a, b) {
          b.kill();
          enemy_3.body.velocity.x = 0;
          enemy_3.animations.stop();
          enemy_3.animations.play('arrowright');
          enemy_3_down = true;
          game.time.events.add(1000, function () {
            if (enemy_3_newposition > enemy_3_oldposition) {
              enemy_3.body.velocity.x = enemy_speed;
            } else if (enemy_3_newposition < enemy_3_oldposition) {
              enemy_3.body.velocity.x = -enemy_speed;
            }
            enemy_3_down = false;
          });
        }
        //movements
        enemy_3_newposition = enemy_3.x;
        if ((enemy_3_down == false) && (enemy_3_newposition > enemy_3_oldposition)) {
          enemy_3.animations.play('enemyright');
          enemy_3_oldposition = enemy_3_newposition;
        } else if ((enemy_3_down == false) && (enemy_3_newposition < enemy_3_oldposition)) {
          enemy_3.animations.play('enemyleft');
          enemy_3_oldposition = enemy_3_newposition;
        }
        if (enemy_3.x > 5450) {
          enemy_3.body.velocity.x = -enemy_speed;
        } else if (enemy_3.x < 5200) {
          enemy_3.body.velocity.x = enemy_speed;
        }


        //enemy_4
        function collision_malebulletright_enemy_4(a, b) {
          b.kill();
          enemy_4.body.velocity.x = 0;
          enemy_4_down = true;
          enemy_4.body.setSize(1, 1, 0, -1000)
          enemy_4.animations.stop();
          enemy_4.animations.play('starleft');
          game.time.events.add(3500, function () {
            if (enemy_4_newposition > enemy_4_oldposition) {
              enemy_4.body.velocity.x = enemy_speed;
            } else if (enemy_4_newposition < enemy_4_oldposition) {
              enemy_4.body.velocity.x = -enemy_speed;
            }
            enemy_4_down = false;
            enemy_4.body.setSize(78, 105, 0, 0)
          });
        }
        function collision_femalebulletright_enemy_4(a, b) {
          b.kill();
          enemy_4.body.velocity.x = 0;
          enemy_4.animations.stop();
          enemy_4.animations.play('arrowleft');
          enemy_4_down = true;
          game.time.events.add(1000, function () {
            if (enemy_4_newposition > enemy_4_oldposition) {
              enemy_4.body.velocity.x = enemy_speed;
            } else if (enemy_4_newposition < enemy_4_oldposition) {
              enemy_4.body.velocity.x = -enemy_speed;
            }
            enemy_4_down = false;
          });
        }
        function collision_malebulletleft_enemy_4(a, b) {
          b.kill();
          enemy_4.body.velocity.x = 0;
          enemy_4_down = true;
          enemy_4.body.setSize(1, 1, 0, -1000)
          enemy_4.animations.stop();
          enemy_4.animations.play('starright');
          game.time.events.add(3500, function () {
            if (enemy_4_newposition > enemy_4_oldposition) {
              enemy_4.body.velocity.x = enemy_speed;
            } else if (enemy_4_newposition < enemy_4_oldposition) {
              enemy_4.body.velocity.x = -enemy_speed;
            }
            enemy_4_down = false;
            enemy_4.body.setSize(78, 105, 0, 0)
          });
        }
        function collision_femalebulletleft_enemy_4(a, b) {
          b.kill();
          enemy_4.body.velocity.x = 0;
          enemy_4.animations.stop();
          enemy_4.animations.play('arrowright');
          enemy_4_down = true;
          game.time.events.add(1000, function () {
            if (enemy_4_newposition > enemy_4_oldposition) {
              enemy_4.body.velocity.x = enemy_speed;
            } else if (enemy_4_newposition < enemy_4_oldposition) {
              enemy_4.body.velocity.x = -enemy_speed;
            }
            enemy_4_down = false;
          });
        }
        //movements
        enemy_4_newposition = enemy_4.x;
        if ((enemy_4_down == false) && (enemy_4_newposition > enemy_4_oldposition)) {
          enemy_4.animations.play('enemyright');
          enemy_4_oldposition = enemy_4_newposition;
        } else if ((enemy_4_down == false) && (enemy_4_newposition < enemy_4_oldposition)) {
          enemy_4.animations.play('enemyleft');
          enemy_4_oldposition = enemy_4_newposition;
        }
        if (enemy_4.x > 7600) {
          enemy_4.body.velocity.x = -enemy_speed;
        } else if (enemy_4.x < 7300) {
          enemy_4.body.velocity.x = enemy_speed;
        }


        //enemy_5
        function collision_malebulletright_enemy_5(a, b) {
          b.kill();
          enemy_5.body.velocity.x = 0;
          enemy_5_down = true;
          enemy_5.body.setSize(1, 1, 0, -1000)
          enemy_5.animations.stop();
          enemy_5.animations.play('starleft');
          game.time.events.add(3500, function () {
            if (enemy_5_newposition > enemy_5_oldposition) {
              enemy_5.body.velocity.x = enemy_speed;
            } else if (enemy_5_newposition < enemy_5_oldposition) {
              enemy_5.body.velocity.x = -enemy_speed;
            }
            enemy_5_down = false;
            enemy_5.body.setSize(78, 105, 0, 0)
          });
        }
        function collision_femalebulletright_enemy_5(a, b) {
          b.kill();
          enemy_5.body.velocity.x = 0;
          enemy_5.animations.stop();
          enemy_5.animations.play('arrowleft');
          enemy_5_down = true;
          game.time.events.add(1000, function () {
            if (enemy_5_newposition > enemy_5_oldposition) {
              enemy_5.body.velocity.x = enemy_speed;
            } else if (enemy_5_newposition < enemy_5_oldposition) {
              enemy_5.body.velocity.x = -enemy_speed;
            }
            enemy_5_down = false;
          });
        }
        function collision_malebulletleft_enemy_5(a, b) {
          b.kill();
          enemy_5.body.velocity.x = 0;
          enemy_5_down = true;
          enemy_5.body.setSize(1, 1, 0, -1000)
          enemy_5.animations.stop();
          enemy_5.animations.play('starright');
          game.time.events.add(3500, function () {
            if (enemy_5_newposition > enemy_5_oldposition) {
              enemy_5.body.velocity.x = enemy_speed;
            } else if (enemy_5_newposition < enemy_5_oldposition) {
              enemy_5.body.velocity.x = -enemy_speed;
            }
            enemy_5_down = false;
            enemy_5.body.setSize(78, 105, 0, 0)
          });
        }
        function collision_femalebulletleft_enemy_5(a, b) {
          b.kill();
          enemy_5.body.velocity.x = 0;
          enemy_5.animations.stop();
          enemy_5.animations.play('arrowright');
          enemy_5_down = true;
          game.time.events.add(1000, function () {
            if (enemy_5_newposition > enemy_5_oldposition) {
              enemy_5.body.velocity.x = enemy_speed;
            } else if (enemy_5_newposition < enemy_5_oldposition) {
              enemy_5.body.velocity.x = -enemy_speed;
            }
            enemy_5_down = false;
          });
        }
        //movements
        enemy_5_newposition = enemy_5.x;
        if ((enemy_5_down == false) && (enemy_5_newposition > enemy_5_oldposition)) {
          enemy_5.animations.play('enemyright');
          enemy_5_oldposition = enemy_5_newposition;
        } else if ((enemy_5_down == false) && (enemy_5_newposition < enemy_5_oldposition)) {
          enemy_5.animations.play('enemyleft');
          enemy_5_oldposition = enemy_5_newposition;
        }
        if (enemy_5.x > 13550) {
          enemy_5.body.velocity.x = -enemy_speed;
        } else if (enemy_5.x < 13325) {
          enemy_5.body.velocity.x = enemy_speed;
        }

        //enemy_6
        function collision_malebulletright_enemy_6(a, b) {
          b.kill();
          enemy_6.body.velocity.x = 0;
          enemy_6_down = true;
          enemy_6.body.setSize(1, 1, 0, -1000)
          enemy_6.animations.stop();
          enemy_6.animations.play('starleft');
          game.time.events.add(3500, function () {
            if (enemy_6_newposition > enemy_6_oldposition) {
              enemy_6.body.velocity.x = enemy_speed;
            } else if (enemy_6_newposition < enemy_6_oldposition) {
              enemy_6.body.velocity.x = -enemy_speed;
            }
            enemy_6_down = false;
            enemy_6.body.setSize(78, 105, 0, 0)
          });
        }
        function collision_femalebulletright_enemy_6(a, b) {
          b.kill();
          enemy_6.body.velocity.x = 0;
          enemy_6.animations.stop();
          enemy_6.animations.play('arrowleft');
          enemy_6_down = true;
          game.time.events.add(1000, function () {
            if (enemy_6_newposition > enemy_6_oldposition) {
              enemy_6.body.velocity.x = enemy_speed;
            } else if (enemy_6_newposition < enemy_6_oldposition) {
              enemy_6.body.velocity.x = -enemy_speed;
            }
            enemy_6_down = false;
          });
        }
        function collision_malebulletleft_enemy_6(a, b) {
          b.kill();
          enemy_6.body.velocity.x = 0;
          enemy_6_down = true;
          enemy_6.body.setSize(1, 1, 0, -1000)
          enemy_6.animations.stop();
          enemy_6.animations.play('starright');
          game.time.events.add(3500, function () {
            if (enemy_6_newposition > enemy_6_oldposition) {
              enemy_6.body.velocity.x = enemy_speed;
            } else if (enemy_6_newposition < enemy_6_oldposition) {
              enemy_6.body.velocity.x = -enemy_speed;
            }
            enemy_6_down = false;
            enemy_6.body.setSize(78, 105, 0, 0)
          });
        }
        function collision_femalebulletleft_enemy_6(a, b) {
          b.kill();
          enemy_6.body.velocity.x = 0;
          enemy_6.animations.stop();
          enemy_6.animations.play('arrowright');
          enemy_6_down = true;
          game.time.events.add(1000, function () {
            if (enemy_6_newposition > enemy_6_oldposition) {
              enemy_6.body.velocity.x = enemy_speed;
            } else if (enemy_6_newposition < enemy_6_oldposition) {
              enemy_6.body.velocity.x = -enemy_speed;
            }
            enemy_6_down = false;
          });
        }
        //movements
        enemy_6_newposition = enemy_6.x;
        if ((enemy_6_down == false) && (enemy_6_newposition > enemy_6_oldposition)) {
          enemy_6.animations.play('enemyright');
          enemy_6_oldposition = enemy_6_newposition;
        } else if ((enemy_6_down == false) && (enemy_6_newposition < enemy_6_oldposition)) {
          enemy_6.animations.play('enemyleft');
          enemy_6_oldposition = enemy_6_newposition;
        }
        if (enemy_6.x > 13250) {
          enemy_6.body.velocity.x = -enemy_speed;
        } else if (enemy_6.x < 13025) {
          enemy_6.body.velocity.x = enemy_speed;
        }

        //enemy_7
        function collision_malebulletright_enemy_7(a, b) {
          b.kill();
          enemy_7.body.velocity.x = 0;
          enemy_7_down = true;
          enemy_7.body.setSize(1, 1, 0, -1000)
          enemy_7.animations.stop();
          enemy_7.animations.play('starleft');
          game.time.events.add(3500, function () {
            if (enemy_7_newposition > enemy_7_oldposition) {
              enemy_7.body.velocity.x = enemy_speed;
            } else if (enemy_7_newposition < enemy_7_oldposition) {
              enemy_7.body.velocity.x = -enemy_speed;
            }
            enemy_7_down = false;
            enemy_7.body.setSize(78, 105, 0, 0)
          });
        }
        function collision_femalebulletright_enemy_7(a, b) {
          b.kill();
          enemy_7.body.velocity.x = 0;
          enemy_7.animations.stop();
          enemy_7.animations.play('arrowleft');
          enemy_7_down = true;
          game.time.events.add(1000, function () {
            if (enemy_7_newposition > enemy_7_oldposition) {
              enemy_7.body.velocity.x = enemy_speed;
            } else if (enemy_7_newposition < enemy_7_oldposition) {
              enemy_7.body.velocity.x = -enemy_speed;
            }
            enemy_7_down = false;
          });
        }
        function collision_malebulletleft_enemy_7(a, b) {
          b.kill();
          enemy_7.body.velocity.x = 0;
          enemy_7_down = true;
          enemy_7.body.setSize(1, 1, 0, -1000)
          enemy_7.animations.stop();
          enemy_7.animations.play('starright');
          game.time.events.add(3500, function () {
            if (enemy_7_newposition > enemy_7_oldposition) {
              enemy_7.body.velocity.x = enemy_speed;
            } else if (enemy_7_newposition < enemy_7_oldposition) {
              enemy_7.body.velocity.x = -enemy_speed;
            }
            enemy_7_down = false;
            enemy_7.body.setSize(78, 105, 0, 0)
          });
        }
        function collision_femalebulletleft_enemy_7(a, b) {
          b.kill();
          enemy_7.body.velocity.x = 0;
          enemy_7.animations.stop();
          enemy_7.animations.play('arrowright');
          enemy_7_down = true;
          game.time.events.add(1000, function () {
            if (enemy_7_newposition > enemy_7_oldposition) {
              enemy_7.body.velocity.x = enemy_speed;
            } else if (enemy_7_newposition < enemy_7_oldposition) {
              enemy_7.body.velocity.x = -enemy_speed;
            }
            enemy_7_down = false;
          });
        }
        //movements
        enemy_7_newposition = enemy_7.x;
        if ((enemy_7_down == false) && (enemy_7_newposition > enemy_7_oldposition)) {
          enemy_7.animations.play('enemyright');
          enemy_7_oldposition = enemy_7_newposition;
        } else if ((enemy_7_down == false) && (enemy_7_newposition < enemy_7_oldposition)) {
          enemy_7.animations.play('enemyleft');
          enemy_7_oldposition = enemy_7_newposition;
        }
        if (enemy_7.x > 16050) {
          enemy_7.body.velocity.x = -enemy_speed;
        } else if (enemy_7.x < 15775) {
          enemy_7.body.velocity.x = enemy_speed;
        }

        //enemy_8
        function collision_malebulletright_enemy_8(a, b) {
          b.kill();
          enemy_8.body.velocity.x = 0;
          enemy_8_down = true;
          enemy_8.body.setSize(1, 1, 0, -1000)
          enemy_8.animations.stop();
          enemy_8.animations.play('starleft');
          game.time.events.add(3500, function () {
            if (enemy_8_newposition > enemy_8_oldposition) {
              enemy_8.body.velocity.x = enemy_speed;
            } else if (enemy_8_newposition < enemy_8_oldposition) {
              enemy_8.body.velocity.x = -enemy_speed;
            }
            enemy_8_down = false;
            enemy_8.body.setSize(78, 105, 0, 0)
          });
        }
        function collision_femalebulletright_enemy_8(a, b) {
          b.kill();
          enemy_8.body.velocity.x = 0;
          enemy_8.animations.stop();
          enemy_8.animations.play('arrowleft');
          enemy_8_down = true;
          game.time.events.add(1000, function () {
            if (enemy_8_newposition > enemy_8_oldposition) {
              enemy_8.body.velocity.x = enemy_speed;
            } else if (enemy_8_newposition < enemy_8_oldposition) {
              enemy_8.body.velocity.x = -enemy_speed;
            }
            enemy_8_down = false;
          });
        }
        function collision_malebulletleft_enemy_8(a, b) {
          b.kill();
          enemy_8.body.velocity.x = 0;
          enemy_8_down = true;
          enemy_8.body.setSize(1, 1, 0, -1000)
          enemy_8.animations.stop();
          enemy_8.animations.play('starright');
          game.time.events.add(3500, function () {
            if (enemy_8_newposition > enemy_8_oldposition) {
              enemy_8.body.velocity.x = enemy_speed;
            } else if (enemy_8_newposition < enemy_8_oldposition) {
              enemy_8.body.velocity.x = -enemy_speed;
            }
            enemy_8_down = false;
            enemy_8.body.setSize(78, 105, 0, 0)
          });
        }
        function collision_femalebulletleft_enemy_8(a, b) {
          b.kill();
          enemy_8.body.velocity.x = 0;
          enemy_8.animations.stop();
          enemy_8.animations.play('arrowright');
          enemy_8_down = true;
          game.time.events.add(1000, function () {
            if (enemy_8_newposition > enemy_8_oldposition) {
              enemy_8.body.velocity.x = enemy_speed;
            } else if (enemy_8_newposition < enemy_8_oldposition) {
              enemy_8.body.velocity.x = -enemy_speed;
            }
            enemy_8_down = false;
          });
        }
        //movements
        enemy_8_newposition = enemy_8.x;
        if ((enemy_8_down == false) && (enemy_8_newposition > enemy_8_oldposition)) {
          enemy_8.animations.play('enemyright');
          enemy_8_oldposition = enemy_8_newposition;
        } else if ((enemy_8_down == false) && (enemy_8_newposition < enemy_8_oldposition)) {
          enemy_8.animations.play('enemyleft');
          enemy_8_oldposition = enemy_8_newposition;
        }
        if (enemy_8.x > 16900) {
          enemy_8.body.velocity.x = -enemy_speed;
        } else if (enemy_8.x < 16575) {
          enemy_8.body.velocity.x = enemy_speed;
        }











        //boss_fight
        function collision_malebullet_cancello_boss_fight_1(a, b) {
          b.kill();
        }

        function collision_malebullet_cancello_boss_fight_2(a, b) {
          b.kill();
        }

        function collision_femalebullet_cancello_boss_fight_1(a, b) {
          b.kill();
        }

        function collision_femalebullet_cancello_boss_fight_2(a, b) {
          b.kill();
        }

        function collision_towerbullet_wall_4(a, b) {
          b.kill();
        }

        function collision_malebullet_boss(a, b) {
          b.kill();
          boss_hp -= 1;
          robin.animations.play('robin_confuso');
          boss_is_down = true;
          robin.tint = 0xff0000;
          game.time.events.add(200, function () {
            robin.tint = 0xffffff;
          });
          if (boss_hp > 0) {
            cancello_boss_fight_1.body.velocity.y = -125;
          }

          if (boss_hp == 5) {
            game.time.events.remove(arrowloop_1);
          } else if (boss_hp == 4) {
            game.time.events.remove(arrowloop_2);
            game.time.events.remove(arrowloop_3);
            game.time.events.remove(arrowloop_4);
          } else if (boss_hp == 3) {
            game.time.events.remove(arrowloop_5);
            game.time.events.remove(arrowloop_6);
            game.time.events.remove(arrowloop_7);
          } else if (boss_hp == 2) {
            game.time.events.remove(arrowloop_8);
            game.time.events.remove(arrowloop_9);
          } else if (boss_hp == 1) {
            game.time.events.remove(arrowloop_10);
            game.time.events.remove(arrowloop_11);
          } else if (boss_hp == 0) {
            game.time.events.remove(arrowloop_12);
            game.time.events.remove(arrowloop_13);
            game.time.events.remove(arrowloop_14);
            game.time.events.remove(arrowloop_15);
            game.time.events.remove(arrowloop_16);
          }
        }

        function collision_femalebullet_target_boss(a, b) {
          a.kill();
          b.kill();
          if (change_gate == false) {
            cancello_boss_fight_2.body.velocity.y = 50;
            game.time.events.add(6000, function () {
              cancello_boss_fight_2.body.velocity.y = -35;
            });
            if (boss_hp > 0) {
              rigenera_target_alto = true;
            }
          }
          if (change_gate == true) {
            cancello_boss_fight_1.body.velocity.y = 50;
            game.time.events.add(6000, function () {
              cancello_boss_fight_1.body.velocity.y = -50;
            });
            if (boss_hp > 0) {
              rigenera_target_basso = true;
            }
          }
        }

        if (rigenera_target_alto == true) {
          rigenera_target_alto = false;
          timer_target_attivo = true;
          evento_target_boss_alto = game.time.events.add(10000, function () {
            timer_target_attivo = false;
            target_boss = game.add.sprite(26075, 220, 'bersaglio');
            game.physics.arcade.enable(target_boss);
            target_boss.body.immovable = true;
            target_boss.body.velocity.y = 75;
            change_gate = true;
          });
        }

        if (rigenera_target_basso == true) {
          rigenera_target_basso = false;
          timer_target_attivo = true;
          evento_target_boss_basso = game.time.events.add(10000, function () {
            timer_target_attivo = false;
            target_boss = game.add.sprite(26075, 580, 'bersaglio');
            game.physics.arcade.enable(target_boss);
            target_boss.body.immovable = true;
            target_boss.body.velocity.y = 75;
            change_gate = false;
          });
        }

        if (target_boss.y > 575) {
          target_boss.body.velocity.y = -75;
        } else if (target_boss.y < 200) {
          target_boss.body.velocity.y = 75;
        }

        if (cancello_boss_fight_2.y < 607) {
          cancello_boss_fight_2.body.velocity.y = 0;
          cancello_boss_fight_2.y = 607;
        }

        if (cancello_boss_fight_2.y > 730) {
          cancello_boss_fight_2.body.velocity.y = 0;
          cancello_boss_fight_2.y = 730;
        }

        if (cancello_boss_fight_1.y < 275) {
          cancello_boss_fight_1.body.velocity.y = 0;
          cancello_boss_fight_1.y = 275;
        }

        if (cancello_boss_fight_1.y > 390) {
          cancello_boss_fight_1.body.velocity.y = 0;
          cancello_boss_fight_1.y = 390;
        }

        function collision_towerbullet_player(a, b) {
          b.kill();
          player_hp -= 1;
          player.tint = 0xff0000;
          game.time.events.add(200, function () {
            player.tint = 0xffffff;
          });
        }








        //boss_room
        if (player.x > 25400 && inside_boss_room == false) {
          inside_boss_room = true;
          boss_start_dialogo = true;
          variabili_giocatore = true;

          wall_1.body.enable = true;
          wall_2.body.enable = true;

          cancello_boss_room.body.velocity.y = -200;

          barra_cutscene.fixedToCamera = false;
          barra_cutscene.body.velocity.y = 200;

          robin.animations.play('robin_fermo_cattivo');
        }
        if (cancello_boss_room.y < 560) {
          cancello_boss_room.body.velocity.y = 0;
        }
        if (barra_cutscene.y > -85) {
          barra_cutscene.body.velocity.y = 0;
        }


        if (player.x > 25790) {
          game.camera.follow(camera_fix, Phaser.Camera.FOLLOW_LOCKON, 0.1, 0.1);
          if (variabili_giocatore == true) {
            salta_dialogo.visible = true;
            blocca_giocatore = true;
          }
          if (blocca_giocatore == true) {
            if (female == true) {
              player.animations.play('stoprightE');
            }
            if (male == true) {
              player.animations.play('stoprightG');
            }

          }

          game.time.events.add(1500, function () {
            if (boss_start_dialogo == true) {
              variabili_giocatore = false;
              blocca_giocatore = false;
              boss_start_dialogo = false;
              scorrimento_dialogo_i = true;
              dialogo_finale1.visible = true;
              game.paused = true;
            }
          });
        }


        if (start_boss_fight == true) {
          start_boss_fight = false;
          game.time.events.add(1000, function () {
            piattaforma_boss_1.visible = true;
            piattaforma_boss_2.visible = true;
            piattaforma_boss_3.visible = true;
          });
          game.time.events.add(4000, function () {
            target_boss.visible = true;
            target_boss.body.velocity.y = 75;
          });
          arrowloop_1 = game.time.events.loop(5000, function () {
            arrowloop_avviato = true;
            towerbullet_1.fire();
            towerbullet_2.fire();
            towerbullet_3.fire();
            robin.animations.play('robin_spara');
          });
        }














        //reset_player
        if (player_hp == 0 && checkpoint_5_status == true) {
          if (bomb_is_placed == true) {
            explosion.kill();
          }
          piattaforma_boss_1.visible = false;
          piattaforma_boss_2.visible = false;
          piattaforma_boss_3.visible = false;

          barra_cutscene.kill();
          barra_cutscene = game.add.sprite(-100, -300, 'barra_cutscene');
          game.physics.arcade.enable(barra_cutscene);
          barra_cutscene.fixedToCamera = true;

          salta_dialogo.kill();
          salta_dialogo = game.add.sprite(902, 162, 'salta');
          salta_dialogo.fixedToCamera = true;
          salta_dialogo.visible = false;

          if (timer_target_attivo == true) {
            game.time.events.remove(evento_target_boss_alto);
            game.time.events.remove(evento_target_boss_basso);
          }
          target_boss.kill();
          game.time.events.add(2000, function () {
            target_boss = game.add.sprite(26075, 220, 'bersaglio');
            game.physics.arcade.enable(target_boss);
            target_boss.visible = false;
          });

          if (boss_hp == 6 && arrowloop_avviato == true) {
            game.time.events.remove(arrowloop_1);
            arrowloop_avviato = false;
          } else if (boss_hp == 5) {
            game.time.events.remove(arrowloop_2);
            game.time.events.remove(arrowloop_3);
            game.time.events.remove(arrowloop_4);
          } else if (boss_hp == 4) {
            game.time.events.remove(arrowloop_5);
            game.time.events.remove(arrowloop_6);
            game.time.events.remove(arrowloop_7);
          } else if (boss_hp == 3) {
            game.time.events.remove(arrowloop_8);
            game.time.events.remove(arrowloop_9);
          } else if (boss_hp == 2) {
            game.time.events.remove(arrowloop_10);
            game.time.events.remove(arrowloop_11);
          } else if (boss_hp == 1) {
            game.time.events.remove(arrowloop_12);
            game.time.events.remove(arrowloop_13);
            game.time.events.remove(arrowloop_14);
            game.time.events.remove(arrowloop_15);
            game.time.events.remove(arrowloop_16);
          }

          render_gameover.visible = true;
          gameover = true;
          game.paused = true;
        }










        //boss_hp
        if (boss_hp == 5) {
          hp_6_R.visible = false;
          hp_5_R.visible = true;

        } else if (boss_hp == 4) {
          hp_5_R.visible = false;
          hp_4_R.visible = true;

        } else if (boss_hp == 3) {
          hp_4_R.visible = false;
          hp_3_R.visible = true;

        } else if (boss_hp == 2) {
          hp_3_R.visible = false;
          hp_2_R.visible = true;

        } else if (boss_hp == 1) {
          hp_2_R.visible = false;
          hp_1_R.visible = true;

        } else if (boss_hp == 0) {
          hp_1_R.visible = false;
          hp_0_R.visible = true;
        }

        //arrowloop_torre
        if (boss_hp == 5 && boss_is_down == true) {
          boss_is_down = false;
          arrowloop_2 = game.time.events.loop(5000, function () {
            towerbullet_1.fire();
          });
          game.time.events.add(500,function () {
            arrowloop_3 = game.time.events.loop(5000, function () {
              towerbullet_2.fire();
            });
          });
          game.time.events.add(1000,function () {
            arrowloop_4 = game.time.events.loop(5000, function () {
              towerbullet_3.fire();
              robin.animations.play('robin_spara');
            });
          });


        } else if (boss_hp == 4 && boss_is_down == true) {
          boss_is_down = false;
          arrowloop_5 = game.time.events.loop(5000, function () {
            towerbullet_3.fire();
            robin.animations.play('robin_spara');
          });
          game.time.events.add(500,function () {
            arrowloop_6 = game.time.events.loop(5000, function () {
              towerbullet_2.fire();
            });
          });
          game.time.events.add(1000,function () {
            arrowloop_7 = game.time.events.loop(5000, function () {
              towerbullet_1.fire();
            });
          });


        } else if (boss_hp == 3 && boss_is_down == true) {
          boss_is_down = false;
          arrowloop_8 = game.time.events.loop(5000, function () {
            towerbullet_2.fire();
          });
          game.time.events.add(500,function () {
            arrowloop_9 = game.time.events.loop(5000, function () {
              towerbullet_1.fire();
              towerbullet_3.fire();
              robin.animations.play('robin_spara');
            });
          });


        } else if (boss_hp == 2 && boss_is_down == true) {
            boss_is_down = false;
            arrowloop_10 = game.time.events.loop(5000, function () {
              towerbullet_1.fire();
              towerbullet_3.fire();
              robin.animations.play('robin_spara');
            });
            game.time.events.add(500,function () {
              arrowloop_11 = game.time.events.loop(5000, function () {
                towerbullet_2.fire();
              });
            });


        } else if (boss_hp == 1 && boss_is_down == true) {
            boss_is_down = false;
            arrowloop_12 = game.time.events.loop(5000, function () {
              towerbullet_1.fire();
            });
            game.time.events.add(500,function () {
              arrowloop_13 = game.time.events.loop(5000, function () {
                towerbullet_2.fire();
              });
            });
            game.time.events.add(1000,function () {
              arrowloop_14 = game.time.events.loop(5000, function () {
                towerbullet_3.fire();
                robin.animations.play('robin_spara');
              });
            });
            game.time.events.add(1500,function () {
              arrowloop_15 = game.time.events.loop(5000, function () {
                towerbullet_2.fire();
              });
            });
            game.time.events.add(2000,function () {
              arrowloop_16 = game.time.events.loop(5000, function () {
                towerbullet_1.fire();
              });
            });
        }

        if (boss_hp == 0 && avvia_render_finale == false) {
          avvia_render_finale = true;
          rimani_aperto = true;

          robin.body.velocity.x = -55;
          robin.body.bounce.y = 0.2;
          robin.animations.play('robin_cammina');
          game.time.events.add(2100, function () {
            blocca_giocatore = true;
            robin.body.gravity.y = gravity;
            robin.animations.play('robin_confuso');
          });

          game.time.events.add(5000, function () {
            robin_atterrato = true;
          });

          game.time.events.remove(evento_target_boss_alto);
          game.time.events.remove(evento_target_boss_basso);
        }
        function collision_robin_floor () {
          robin.body.velocity.x = 0;
        }

        //fine_boss_fight
        if (boss_hp == 0 && rimani_aperto == true) {
            cancello_boss_fight_1.y = 390;
            cancello_boss_fight_1.body.velocity.y = 0;
        }

        if (robin_atterrato == true) {
          robin_atterrato = false;
          scorrimento_dialogo_f = true;
          dialogo_finale7.visible = true;
          game.paused = true;
        }

        if (boss_hp == 0 && finale_normale == true) {
          if (mele_raccolte == true) {
              finale_felice = true;
              render_finalefelice.visible = true;
          }
          render_finale.visible = true;
          game.paused = true;
        }






      }
    }
  </script>
 </div>
</body>

</html>
